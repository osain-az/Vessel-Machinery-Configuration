<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ship Machinery Configuration </title>
    <script src="machinery.js"></script>
    

    <!-- Load c3.css -->

<link href="/c3-0.7.15/" rel="stylesheet">
<!-- Load d3.js and c3.js -->
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="/c3-0.7.15/c3.min.js"></script>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

</head>
<body>
    <style>

    .topnav {
    overflow: hidden;
    background-color: #333;

    }
    .topnav a:hover {
    background-color: #ddd;
    color: black;
    }
    .topnav a {
    float: left;
    color: #f2f2f2;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
    font-size: 17px;
    }
    .status{
      /* text-align: center; */
      margin-left: auto;
      margin-right: auto;
      border: solid  red 2px;
      /* background-color: rgb(109, 77, 160); */
      /* width: 50%; */
    }

    .topnav a.active {
    background-color: #4CAF50;
    color: rgb(87, 43, 158);
    }

 table,td,th {
  border: 1px solid #ddd;
  /* padding: 1px; */

}



thead{
  background-color: blueviolet;
  text-align: center;
  text-transform: uppercase;
  text-decoration-color: #f2f2f2;
}
tr:nth-child(even){background-color: #f2f2f2;}
tr:hover {background-color: #ddd;}
/*  */
#Table,#resisTable,#bat_Table, #genset_Table{
  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
  /* border-collapse: collapse; */
  border-spacing: 1px;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
}

      h2,h1{
          text-align: center;
      }
      .engine, .battery, .genset{
          display: block;
          margin-left: auto;
          margin-right: auto;
          border: solid plum 2px;
      }
      .powerSource{
        display: grid;
        grid-template-columns: auto ;
        grid-template-rows: 1fr;
        grid-auto-flow: column;
        margin: 20px;
         border: solid plum 2px;
      }


      .EEDI_main{
        border: solid #6d5757 2px;
      }
      .EEDI{
        width:100%;
      display: grid;
      grid-template-rows: 1fr;
       grid-auto-flow: column;
      }
      .ME_AE span:last-child{
        border: solid rgb(168, 33, 85) 2px;
        float: right;
        margin-right: 10px;
        padding: 5px;
      }
      .ME_AE span:first-child{
        margin-left: 28%;
        margin-right: 20px;
      }

      .EEDI_ME,.EEDI_ME{
        width : 110%;
       grid-row: 2;
       grid-column: 1;
       text-align: center;
       border : solid  rgb(75, 62, 95) 2px;
      }
      .EEDI_AE span,.EEDI_ME span{
        margin-right: 2px;
      }
      .MEAE2{
        width: 50px;
        margin-left: 2px;
        margin-right: 15px;
      }
      .MEAE{
        width: 10px;
        margin-top: 10px;
      }
      .pilotfuel{
        margin-left: 60px;
      }
      .pilotfuel select{
        padding: 4px;
        border: solid rgb(236, 175, 238) 2px;
      }
      /* .EEDI_opt span{
       margin-left: 15px;
      } */
      .EEDI_opt{
         width : 90%;
        margin-left : 10%;
       grid-row: 2;
       grid-column: 2;
       text-align: center;
       border : solid  rgb(75, 62, 95) 2px;
      }

    .range{
     width: 60%;
     margin-bottom: 20px;
     margin-top: 20px;

    }

    .grides{
    width: 60%;
     background-color:rgba(44, 81, 117, 0.7);
    display: grid;
    grid-template-rows: 1fr;
    grid-template-columns: 33% 33% 33%;
    grid-auto-flow: column;
    /* margin: 30px; */
    margin: 15px;

    }
    .hull,.appendage,.SternBulbous,.simulation{
      width: 100%;

     /* background-color:rgba(44, 81, 117, 0.7); */
    display: grid;
    grid-template-rows: 1fr;
    grid-template-columns: 50% 50%;
    grid-auto-flow: column;
    /* margin: 30px; */
    margin: 15px;
    }

    .shipDimension{
        width: 50%;
        margin-left: 1px;
        margin-right: 5%;
    }
    .hull_input_span{
      display:inline-block;
     width:80%;
    }

    .input_div span {cursor:pointer; }
		.input_div span{
			width: auto;
			height:20px;
			background:#f2f2f2;
			border-radius:4px;
			padding:8px 5px 8px 5px;
			border:1px solid #ddd;
      display: inline-block;
      vertical-align: middle;
      text-align: center;
		}
    .input_div .span_name,.sizing_input span, .size_result span{
		 width: auto;
			height:20px;
			background:#f2f2f2;
			border-radius:4px;
			padding:8px 5px 8px 5px;
      margin-right:15px;
			border:1px solid #ddd;
      display: inline-block;
      vertical-align: middle;
      text-align: center;
		}
		.input_div input,.sizing_input input{
			height:34px;
      width: 100px;
      text-align: center;
      font-size: 18px;
			border:1px solid #ddd;
			border-radius:4px;
      display: inline-block;
      vertical-align: middle;
    }
    .resistance_hull_container{
         display: grid;
         grid-template-rows: 1fr;
         grid-template-columns:  55% 45%;
        grid-auto-flow: column;
        margin: 15px;
        margin-left: 0;
        border: solid pink 2px;
    }

  .align{
    border: solid#ddd 2px;
    display: inline-block;
    margin-bottom: 10px;
    margin-top:10px;
    margin-right: 0px;
    padding: 2px;
  }
  .input_check{
    width: auto !important;
    height: auto !important;
  }
 .align_right{
      border: solid#ddd 2px;
      margin-right: 10px;
      margin-bottom: 10px;
      margin-top:10px;
      float: right;
      clear: both;
      padding: 2px;
    }
     .sta_wave{
       border: solid #ddd 2px;
       margin-top:10px;
       margin-left: 10px;
       margin-right: 10px;
       padding: 10px;
     }
     .sta_wave_center{
        display:block !important;
        text-align: center;
        padding: 5px;

     }
    .header span{
      display: block !important;
      text-align: center;
      background:#f2f2f2;
      font-size: 20px;
      margin-top: 10px;
      margin-bottom: 10px;
      padding: 5px;
    }
    .propellChoice{
      border: solid pink 2px;
      margin-top: 15px;
      margin-bottom: 15px;

    }
    .spanNew{
      border: solid#ddd 2px;
      margin-right: 10px;
      float: right;
    clear: both;
    padding: 2px;
    }
    .hullDimension,.resistance ,.appendage {
        width: 100%;
        /* background-color:rgba(44, 81, 117, 0.7); */
        grid-template-rows: 1fr;
         grid-template-columns:  auto;
        grid-auto-flow: column;
        margin: 15px;
        margin-left: 0;
    }
    .hull > h2{
        text-align: center;
        grid-row: 1;
        grid-column: 1;

    }

    .resistance {
      border: solid 2px grey;
    grid-row: 2;
    grid-column: 2;
    }
    .hullDimension {
      border: solid 2px grey;
    grid-row: 2;
    grid-column: 1;
    }


    #resisTable{
      width: 90%;
      margin-top: 30px;
    }

    .appendage{
      width: 100%;
    grid-template-rows: 1fr;
    grid-auto-flow: column;

    }
    .inputArea{
        width: 50%;
    }
    .addedResistance{
      margin-left: 15px;
    }

    /* //Propeller */

    .propeller{
      margin: 15px;
    }
    .propellChoice{
      display: flex;
      flex-wrap: nowrap;
      margin-bottom: 20px;
    }
    .screw,.shaft {
      margin-left: 15px;
    }

    .propulsion_type input{
      margin-right: 5%;
    }.propulsion_type input:last-child{
      margin-right: 1%;
    }
    .propulsion_type span:first-child{
      margin-left: 10%;
    }
     .battery_sizing,.size_resul{
      border: solid#ddd 2px;
      width: 100%;
      padding: 15px;

     }
    .size_result,.sizing_info,.sizing_input{
      border: solid#ddd 2px;
      /* margin-right:; */
      padding: 15px;
      margin-left: 20px;
      margin-bottom: 10px;
      margin-top:10px;
    }
    .simulation{
     /* background-color:rgba(0, 2, 4, 0.7); */
     background-color:rgba(44, 81, 117, 0.7);
     width: 97%;
    display: grid;
    grid-template-rows: 1fr;
    grid-template-columns: auto;
    grid-auto-flow: column;
    margin: auto;
    }
    .start_sim,.view_data{
      text-align: center;
      margin: 15px;
      /* color: rgb(104, 86, 86); */
      padding: 7px;
      font-size: 20px;
      cursor: pointer;
       background-color: rgb(77, 190, 73);
      border :solid rgb(110, 100, 4) 2px;
      border-radius: 10px;
    }

    .create_custo_bat,.create_custo_genset,.create_custo_engine
    {
     float: right;
     margin-right: 15%;
     padding: 6px;

    }
   .custom_button,.tableconfirm,.select_message_butt{
     padding: 12px;
     color: white;
     cursor: pointer;
     font-size: 20px;
     border-radius: 10px;
     border :solid hotpink 2px;
     background-color: rgb(46, 84, 88);
    }
    .sellected_pro{
     /* background-color:rgba(0, 2, 4, 0.7); */
     background-color:rgba(44, 81, 117, 0.7);
     width: 97%;
    display: grid;
    grid-template-rows: 1fr;
    grid-template-columns: auto;
    grid-auto-flow: column;
    margin: auto;

    }

    .engine_perf,.close {
      padding: 12px;
      border: solid rgb(46, 117, 98) 2px;
     cursor: pointer;
     border-radius: 6px;
     font-size: 20px;
     margin:15px;
    }
   .battery_sizing{
    width: 100%;
    display: grid;
    grid-template-rows: 1fr;
    grid-template-columns: 33% 33% 33%;
    grid-auto-flow: column;
    margin: auto;

   }


   .sim{
     width: 60px;
     margin-left: 10px;
   }
       .mainDashboard{

        display: flex;
        flex-wrap: nowrap;
        background-color: #01040edb;
    }
    .mainDashboard > .dashboardControl{

       margin-left: 15px;
    }
    .dashboardControl{

    width: 40%;
     /* background-color:rgba(0, 2, 4, 0.7); */
     background-color:rgba(44, 81, 117, 0.7);
    display: grid;
    grid-template-rows: 1fr;
    /* grid-template-columns: 33% 33% auto; */
    grid-auto-flow: column;
    margin: 15px;
    margin-left: 0;

    }

   .profile input{
     margin-left: 5px;
   }

.testin{
        margin: 30px;
        color: green;
        font-size: 1.3em;
    }
    .chart{
        border: solid #333 2px;
        text-decoration-color: aqua;
        background-color:#91b3aea3;
    }
    .chartDisp{
        margin: 15px;
        color: aqua;
        font-size: 1.3em;
    }
    .engineInput{
        color: aqua;
        margin-left: 20px;
    }

    .hide {
    display: none;
    }
    .center{
      text-align: center;
    }

    .power{
    grid-row: 1;
    grid-column: 1;
    }
    .RPM{
    grid-row: 1;
    grid-column: 3;
    }
    .torque{
    grid-row: 1;
    grid-column: 2;
    }

    .loadwatt{
    grid-row: 2;
    grid-column: 2;
    }
    /* .SFOC{
     grid-row: 2;
      grid-column: 3;
    } */
      .column {
        flex: 50%;
        padding: 40px;
       }
       .row{
    display: flex;

     }
     .powerOn{
       border: solid rgb(7, 7, 7) 5px;
       padding: 4px;
       margin-top: 12px;
       border-radius: 5px;
     }
     .done{
      border: solid rgb(7, 7, 7) 5px;
       padding: 4px;
       margin-top: 12px;
       float: right;
       margin-right: 6px;
     }
    .sim_ploting {
       display: grid;
       grid-template-rows: 1fr;
       grid-template-columns: 25% 30% 45%;
     grid-auto-flow: column;
    border: solid green 2px;
    }

    #emission{
      position: relative;
     margin: auto;
     width: 100%;
    }
    /* #result{
      width:50%;
    } */
    #update_top{
   margin-bottom: 20px ;
    }

    .darshboard_container,.result_compare{
      width: 100%;
      background-color:#072b39;
      height: 100%;
      color: white;
      padding: 15px;
    }
 
    .c3-axis-y-label,.c3-axis-y,.c3-legend-item-tile  {
      stroke: #fff !important;
    }
    /* .add_style{
      background-color: #f7f7f7;
      background-image: -webkit-gradient(linear, left top, left bottom, from(#f7f7f7), to(#e7e7e7));
      background-image: -webkit-linear-gradient(top, #f7f7f7, #e7e7e7);
      background-image: -moz-linear-gradient(top, #f7f7f7, #e7e7e7);
      background-image: -ms-linear-gradient(top, #f7f7f7, #e7e7e7);
      background-image: -o-linear-gradient(top, #f7f, #e7e7e7);
      color: #a7a7a7;
      margin: 36px;
      width: 144px;
      height: 144px;
      position: relative;
      text-align: center;
      line-height: 166px;
       border-radius: 50%;
      box-shadow: 0px 3px 8px #aaa, inset 0px 2px 3px #fff;
    } */
    .section{
      margin: 5px;
      border: solid #aaa 1px;
      box-shadow: 0px 3px 8px #daf, inset 0px 2px 3px #fff;

    }
    .span_disp{
      display: inline-block;
      margin: 10px;
      padding: 6px;
    }
    .darsh_top span{
     display: inline-block;
      border: solid greenyellow 2px;
      margin-left: auto;
      border-radius: 20%;
      margin-bottom: 10px;
      padding: 5px;
      margin-top: 15px;
      margin-right: auto;
      text-align: center;
      box-shadow: 0px 3px 8px #aaa, inset 0px 2px 3px #fff;
    }
    .span_result{
      background-color: #092e45;
      display: inline-block;
      color: #a7a7a7;
      margin: 10px;
      width: 80px;
      height: 80px;
      font-size: 12px;
      position: relative;
      text-align: center;
      border: solid #36e4f4 2px;
      line-height: 35px;
       border-radius: 50%;
      box-shadow: 0px 3px 8px #aaa, inset 0px 2px 3px #fff;
    }
    .live_data{
      color: #3bc140;
      font-size: 1.3em;
    }
    .result_button input{
    background-color: #092e45;
    color: #3bc140;
    margin: 20px;
    padding:6px;
    border: solid #36e4f4 2px;
    border-radius: 15px;
    font-size: 1.3em;
    }
    .result_canvas{
      width: 60%;
      margin-left: auto;
     margin-right: auto;
    }
    .insight_header{
      display: block !important;
      text-align: center;
      width: fit-content;
      border: solid #36e4f4 2px ;
      border-radius: 10px;
      margin-left: auto;
      margin-right: auto;
      font-size: 20px;
      margin-top: 10px;
      padding: 5px;
      margin-left: auto;
      margin-right: auto;
    }

   .addedMachinery{
         background-color:#051c26;
         width: 100%;
         margin-left: auto;
         margin-right: auto;

     }
     .img_display{
       transform: rotate(90deg);

     }
     /* .ship_move{
      animation: mymove 12s infinite;
      animation-timing-function: linear;
      position: relative;
     }
     @keyframes mymove {
      from{left: -30%;}
       to {left: 100%;}
     } */

    </style>
    <div class="topnav">
        <a class="active" href="#home">Home</a>
        <a href="https://github.com/osain-az/Vessel-Machinery-Configuration">GitHub Rep</a>
        <a  href="information/index.html">information</a>
         <!-- <a href="Flowchat/"> Flowchat and Status </a> -->
         <!-- https://osain-az.github.io/Vessel-Machinery-Configuration/ -->
        <!-- <a href="#about"></a> -->
      </div>

    <!-- <p>This example demonstrates how to dynamically update a slider value with oninput.</p>

    this:<input type="range" step="5" oninput="myFunction(this.value)">
    <p id="demo"></p> -->
       <h1 class="status">Note: Site still under development, UI will be the last thing to be designed   </h1>

    <div class="main">
        <h1>Ship Machinery Configuration and Simulation</h1>
        <div>
            <h2>Hull dimensions  and resistance display </h2>
         <div class="resistance_hull_container">
             <div class="resistance_parameters">
              <form action="" onchange="shipDimension(event)" onclick="handle_inputs(event)">
                <div class="input_div align">
                  <span class="span_name">speed</span>
                   <span data-name=" kn" id="shipSpeed_minus">--</span>
                   <input type="text" name="" class="" id="shipSpeed" min="5" value="10.69 kn" max="30" step="0.1" >
                   <span  data-name=" kn" id="shipSpeed_plus">+</span>

                </div>
                <div class="input_div align_right " >
                <span class="span_name">Waterline length Lwl</span>
                <span data-name=" m" id="Lwl_minus">--</span>
                <input type="text" id="Lwl" min="10" value="205 m" max="600" step="5" >
                <span  data-name=" m" id="Lwl_plus">+</span>
                <br>
               </div>
               <div class="input_div align">
                 <span class="span_name">Breath: Bwl:</span>
                 <span data-name=" m" id="Bwl_minus">--</span>
                 <input type="text" id="Bwl" min="5" value="32 m" max="50" step="2" >
                 <span  data-name=" m" id="Bwl_plus">+</span>
                </div>
                <div class="input_div align_right">
                 <span class="span_name">Draught T:</span>
                 <span data-name=" m" id="T_minus">--</span>
                 <input type="text" id="T" min="5" value="10 m" max="30" step="1" >
                 <span  data-name=" m" id="T_plus">+</span>
                 <br>
                </div>
                <div class="input_div align">
                 <span class="span_name">aft Draught TA</span>
                 <span data-name=" m" id="TA_minus">--</span>
                 <input type="text" id="TA" min="5" value="10 m" max="30" step="1" >
                 <span  data-name=" m" id="TA_plus">+</span>
                </div>
                <div class="input_div align_right">
                 <span class="span_name">fmost Draught Tf</span>
                 <span data-name=" m" id="Tf_minus">--</span>
                 <input type="text" id="Tf" min="5" value="10 m" max="30" step="1" >
                 <span  data-name=" m" id="Tf_plus">+</span>
                 <br>
                </div>
                <div class="input_div align">
                 <span class="span_name">ABT</span>
                 <span data-name=" m^2" id="ABT_minus">--</span>
                 <input type="text" id="ABT" min="5" value="13.4848 m^2" max="30" step="0.1">
                 <span  data-name=" m^2" id="ABT_plus">+</span>
                </div>
                <div class="input_div align_right">
                 <span class="span_name">hB</span>
                 <span data-name=" m" id="hB_minus">--</span>
                 <input type="text" id="hB" min="0" value="4 m" max="20" step="0.1">
                 <span  data-name=" m" id="hB_plus">+</span>
                 <br>
               </div> <br>
                <div class="input_div align">
                 <span class="span_name">Transom AT</span>
                 <span data-name=" m^2" id="AT_minus">--</span>
                 <input type="text" id="AT" min="3" value="16 m^2" max="30" step="0.1">
                 <span  data-name=" m^2" id="AT_plus">+</span>
                </div>
                <div class="input_div coefficient align_right">
                 <span class="span_name">CB</span>
                 <span data-name=" " id="Cb_minus">--</span>
                 <input type="text" id="Cb" min="0" value="0.572" max="1" step="0.1">
                 <span  data-name=" " id="Cb_plus">+</span>

               </div> <br>
                <div class="input_div coefficient align">
                 <span class="span_name">CM</span>
                 <span data-name=" " id="Cm_minus">--</span>
                 <input type="text" id="Cm" min="0" value="0.98" max="1" step="0.01">
                 <span  data-name=" " id="Cm_plus">+</span>
                </div>
                <div class="input_div coefficient align_right">
                 <span class="span_name">LCB</span>
                 <select name="" id="lcb_type" >
                   <option value="">lcb reference</option>
                  <option value="aft" selected>Aft</option>
                  <option value="forward">Forward</option>
               </select>
                 <span data-name=" " id="LCB_minus">--</span>
                 <input type="text" id="LCB" min="-10" value="1.53 " max="10" step="0.01">
                 <span  data-name=" " id="LCB_plus">+</span>

                 <div class="input_div align">
                  <span class="span_name">Wetted Area Appendages  S_APP</span>
                  <span data-name=" m^2" id="S_APP_minus">--</span>
                  <input type="text" id="S_APP" min="5" value="0 m" max="1000" step="1" >
                  <span  data-name=" m^2" id="S_APP_plus">+</span>
                 </div>

               </div> <br>
              </form>
              <form action="" onchange="appendageCal(event)" onclick="handle_inputs(event)">
            <div class="">

              <br>

               <div  class="header"><span><strong>Appendages </strong></span></div>
               <br>

            <div class="input_div align">
              <input type="checkbox" id="BilgeKeelAreaCheck" name="" value="" class="input_check">
              <label for="Bilge Keel"> Bilge Keel  Area: </label>
            <span data-name=" m^2" id="BilgeKeelArea_minus">--</span>
              <input type="text" name="" class="" id="BilgeKeelArea" min="0" value="0 m^2" step="0.1" max="60">
            <span  data-name=" m^2" id="BilgeKeelArea_plus">+</span>
            </div>
            <div class="input_div align_right">
              <input type="checkbox" id="DomeAreaCheck" name="bulbous bow" value="" class="input_check">
              <label for="Dome Area"> Dome Area: </label>
            <span data-name=" m^2" id="DomeArea_minus">--</span>
              <input type="text" name="" class="" id="DomeArea" min="0" value="0 m^2" step="0.1" max="60">
            <span  data-name=" m^2" id="DomeArea_plus">+</span>
            </div>
            <div class="input_div align_right">
              <input type="checkbox" id="ShaftBracketAreaCheck" name="bulbous bow" value="" class="input_check">
              <label for="Shafts Area"> Shafts Bracket  Area: </label>
            <span data-name=" m^2" id="ShaftBracketArea_minus">--</span>
              <input type="text" name="" class="" id="ShaftBracketArea" min="0" value="0 m^2" step="0.1" max="60">
            <span  data-name=" m^2" id="ShaftBracketArea_plus">+</span>
            </div>
            <div class="input_div align">
              <input type="checkbox" id="StrutBossingsAreaCheck" name="bulbous bow" value="" class="input_check">
              <label for="Strut Bossings Area"> Strut Bossings  Area: </label>
            <span data-name=" m^2" id="StrutBossingsArea_minus">--</span>
              <input type="text" name="" class="" id="StrutBossingsArea" min="0" value="0 m^2" step="0.1" max="60">
            <span  data-name=" m^2" id="StrutBossingsArea_plus">+</span>
            </div>
            <div class="input_div align_right">
              <input type="checkbox" id="StabilizerFinsCheck" name="bulbous bow" value="" class="input_check">
              <label for="Stabilizer Fins Area">Stabilizer Fins  Area: </label>
            <span data-name=" m^2" id="StabilizerFins_minus">--</span>
              <input type="text" name="" class="" id="StabilizerFins" min="0" value="0 m^2" step="0.1" max="60">
            <span  data-name=" m^2" id="StabilizerFins_plus">+</span>
            </div>
            <div class="input_div align">
              <input type="checkbox" id="hullbossingCheck" name="Hull Bossings" value="" class="input_check">
              <label for="Hull Bossings">Hull Bossings: </label>
            <span data-name=" m^2" id="hullBossings_minus">--</span>
              <input type="text" name="" class="" id="hullBossings" min="0" value="0 m^2" step="0.1" max="60">
            <span  data-name=" m^2" id="hullBossings_plus">+</span>
            </div>
            <div class="input_div align">
              <input type="checkbox" id="rudderBehindSkegCheck" name="" value="" class="input_check">
                 <label for="Rudder behind skeg">  Rudder behind skeg </label>
                 <span data-name=" " id="rudderBehindSkeg_minus">--</span>
               <input type="text" name="" class="" id="rudderBehindSkeg" min="1.5" value="1.5" step="0.1" max="2">
               <span  data-name=" " id="rudderBehindSkeg_plus">+</span>

               Area : <span data-name=" m^2" id="ArearudderBehindSkeg_minus">--</span>
                <input type="text" name="" class="" id="ArearudderBehindSkeg" min="0" value="0 m^2" step="0.1" max="60">
             <span  data-name=" m^2" id="ArearudderBehindSkeg_plus">+</span> <br>
           </div>
           <div class="input_div align">
            <input type="checkbox" id="rudderBehindSternCheck" name="" value="" class="input_check">
               <label for="Rudder behind skeg">  Rudder behind Stern </label>
               <span data-name=" " id="rudderBehindStern_minus">--</span>
             <input type="text" name="" class="" id="rudderBehindStern" min="1.3" value="1.3" step="0.1" max="1.5">
             <span  data-name=" " id="rudderBehindStern_plus">+</span>

             Area : <span data-name=" m^2" id="rudderBehindSternArea_minus">--</span>
              <input type="text" name="" class="" id="rudderBehindSternArea" min="0" value="0 m^2" step="0.1" max="60">
           <span  data-name=" m^2" id="rudderBehindSternArea_plus">+</span> <br>
         </div>
         <div class="input_div align">
          <input type="checkbox" id="SkegCheck" name="Skeg" value="" class="input_check">
          <label for="stern"> Skeg </label>
             <span data-name=" " id="Skeg_minus">--</span>
           <input type="text" name="" class="" id="Skeg" min="1.5" value="1.5" step="0.1" max="2">
           <span  data-name=" " id="Skeg_plus">+</span>

           Area : <span data-name=" m^2" id="SkegArea_minus">--</span>
            <input type="text" name="" class="" id="SkegArea" min="0" value="0 m^2" step="0.1" max="60">
           <span  data-name=" m^2" id="SkegArea_plus">+</span>
       </div>
       <div class="input_div align">
          <input type="checkbox" id="ShaftsCheck" name="Shafts" value="" class="input_check">
          <label for="Shafts"> Shafts </label>
            <span data-name=" " id="Shafts_minus">--</span>
          <input type="text" name="" class="" id="Shafts" min="2" value="2" step="0.1" max="4">
          <span  data-name=" " id="Shafts_plus">+</span>

          Area : <span data-name=" m^2" id="ShaftsArea_minus">--</span>
          <input type="text" name="" class="" id="ShaftsArea" min="0" value="0 m^2" step="0.1" max="60">
        <span  data-name=" m^2" id="ShaftsArea_plus">+</span>
       </div>
      </div>
       <div>
            <div class="input_div align">
              <input type="checkbox" id="thrustercheck" name="thruster" value="thruster" class="input_check">
              <label for="Thruster">Thruster diameter: </label>
            <span data-name=" m" id="thrusterDiameter_minus">--</span>
              <input type="text" name="" class="" id="thrusterDiameter" min="0" value="0 m" step="0.1" max="15">
            <span  data-name=" m" id="thrusterDiameter_plus">+</span>
            <label for="Thruster">Numbers: </label>
            <span data-name=" m" id="thrusterNO_minus">--</span>
            <input type="text" name="" class="" id="thrusterNO" min="0" value="0 m" step="0.1" max="10">
          <span  data-name=" m" id="thrusterNO_plus">+</span>
            </div>
     </div>

   </form>
   <div class="SternBulbous">
    <div class="stern "  >
      <strong>choose Stern Shape</strong>
    <select class="" onchange= "sternType(event)" id="stern">
      <option value="U&Hogner" selected>U with Hogner</option>
     <option value="V"> V</option>
     <option value="Normal"> Normal</option>
     <option value="PramWithGondola">Pram With Gondola</option>
     </select>
  </div>
</div>
<div class="">
  <form action=""onchange="appendageCal(event)">
     <input type="checkbox" id="bulbous" name="bulbous bow" value="bulbous">
     <label for="bulbous bow"> Bulbous bow</label><br>
   </form>
 </div>
 <br>
 <div class="header"><span >Added resistance </span></div>
 <br>
   <div class="added_resistance">
      <div onchange="appendageCal(event)" class="input_div">
          <input type="checkbox" id="Roughness" name="Roughness" value="Roughness" class="input_check">
          <label for="Roughness"> Roughness above 150 μm</label><br>
      </div>
      <div class="input_div sta_wave" >
        <div class="">
        <span class="sta_wave_center">STA wave-1  model </span>
        </div>

        <div onchange="appendageCal(event)"  onclick="handle_inputs(event)"class="input_div align_right">
           <span>max wave height :</span>
           <span  data-name=" m^2" id="H_minus">--</span>
            <input type="text" name="" class="" id="H" min="0" value="4 m^2" step="0.01" max="15" oninput="shipDimension(event)">
            <span  data-name=" m^2" id="H_plus">+</span>
      </div>
      <div onchange="appendageCal(event)"  onclick="handle_inputs(event)"class="input_div align">
         <span> Bow to 95% beam Lb:</span>
         <span  data-name=" m" id="Lb_minus">--</span>
          <input type="text" name="" class="" id="Lb" min="0" value="20 m" step="0.1" max="200" oninput="shipDimension(event)">
          <span  data-name=" m" id="Lb_plus">+</span>
    </div>
    </div>
    <div class="sta_wave">
    <div class=" sta_wave_center input_div">
    <span class="sta_wave_center"> Wind Resistance parameters </span>
    </div>
    <div onchange="appendageCal(event)"  onclick="handle_inputs(event)" class="input_div align_right">
         <span>max wind speed :</span>
        <span  data-name=" m^2" id="windSpeed_minus">--</span>
         <input type="text" name="" class="" id="windSpeed" min="0" value="15.7" step="0.1" max="15" oninput="shipDimension(event)">
         <span  data-name=" m^2" id="windSpeed_plus">+</span>
   </div>
   <div onchange="appendageCal(event)" class="input_div align">
     <span>projection Area </span>
    <input type="text" name="" class="" id="AirArea" min="0" value="0 m^2" step="0.1" max="10000" oninput="shipDimension(event)">
  </div>
</div>
</div>

   </div>
   <div>
      <div class="resistance">
        <div id="resistanceGraph"> </div>
        <div  id="resistanceTable" class="">
          <table id="resisTable" class="Table">
            <thead>

              <th colspan="12">Different Resistance </th>

            </thead>
            <thead>

              <th colspan="">Resistance</th>
              <th colspan=""> kN</th>
            </thead>
            <tr>
              <td>Frictional </td>
              <td><span id="Fr">0</span></td>
            </tr>
            <tr>
              <td>Wave making</td>
              <td><span id="Rw">0</span></td>
            </tr>
            <tr>
              <td>Appendages</td>
              <td><span id="Rapp">0</span></td>
            </tr>
            <tr>
              <td>thruster resistance</td>
              <td><span id="Rtb">0</span></td>
            </tr>
            <tr>
              <td>pressure bulbous bow</td>
              <td><span id="Rb">0</span></td>
            </tr>
            <tr>
              <td>pressure at Transom</td>
              <td><span id="Rtr">0</span></td>
            </tr>
            <tr>
              <td>Mid-ship Correlation</td>
              <td><span id="RA">0</span></td>
            </tr>
            <tr>
              <td>Air resistance</td>
              <td><span id="RAA">0</span></td>
            </tr>
            <tr>
              <td>Wind resistance</td>
              <td><span id="RAA_wind">0</span></td>
            </tr>
            <tr>
              <td>Fouling Resistance </td>
              <td><span id="Rfouling">0</span></td>
            </tr>
            <tr>
              <td>Wave resistance  </td>
              <td><span id="Rwave">0</span></td>
            <!-- </tr>
            <td>Wave m </td>
            <td><span id="Rwave">0</span></td>
          </tr> -->
            <tr>
              <td>Calm water resistance</td>
              <td><span id="RT_calm">0</span></td>
            </tr>
            <td> Extrem condition Resistance </td>
            <td><span id="RT">0</span></td>
          </tr>
          </table>

          <div class="propellChoice">
            <div class="reductionGear">
              <input type="checkbox" id="gear" name="Reduction Gear" value="thruster" onchange="propellers(event)">
              <label for="Reduction Gear">Reduction Gear </label>
            </div>
            <div class="screw">
              <strong>Choose Screw type</strong>
              <select class="" onchange="Shaft(event)" id="screw">
                <option value="singleScrew" selected id="">Single Screw</option>
              <option value="TwinScrew"> Twin Screw</option>
              </select>
            </div>
          </div>

    <div class="propeller" onchange="propellers(event)">
      <h2>Propeller dimension and parameters</h2>
      <h2></h2>
      <form action="" >
      Propeller D: <input type="range" name="" class="inputArea" id="D" min="1" value="6" step="0.01" max="12"><span class="displayD spanNew"id="displayD"> </span> <br> <br>
      N0 of blades Z : <input type="range" name="inputArea" class="inputArea" id="Z" min="2" value="4" step="1" max="7"><span class="displayZ spanNew"id="displayZ"> </span> <br> <br>
      Ae/Ao : <input type="range" name="" class="inputArea" id="AeAo" min="0.3" value="0.70" step="0.05" max="1.05"><span class="displayAeAo spanNew"id="displayAeAo"> </span> <br> <br>
      P/D : <input type="range" name="" class="inputArea" id="PD" min="0.5" value="0.7" step="0.1" max="1.4"><span class="displayPD spanNew"id="displayPD"> </span> <br> <br>
      Advance N0 J : <input type="range" name="" class="inputArea" id="J" min="0" value="0.4" step="0.01" max="2"><span class="displayJ spanNew"id="displayJ"> </span> <br> <br>
    </form>
   </div>
     </div>
    </div>
    <!-- <div class="cavitation center">
      <span><strong>cavitation analysis </strong></span> <br><br>
      <span> updating.... <input type="text" name="" id=""></span> <br>
      <span>updatin.... <input type="text" name="" id=""></span><br><br>
   </div> -->

   <div class="propellerTable">
    <table id="propellerTable" class="Table">
      <thead>
        <th colspan="12">Propeller parameters using  Wageningen B-Screw Series  </th>
      </thead>
      <thead>

        <th colspan="">Parameters</th>
        <th colspan=""> Values</th>
      </thead>

      <tr>
        <td>Wake </td>
        <td><span id="wake">0</span></td>
      </tr>
      <tr>
        <td>KT</td>
        <td><span id="KT">0</span></td>
      </tr>
      <tr>
        <td>KQ</td>
        <td><span id="KQ">0</span></td>
      </tr>
      <tr>
        <td>Hull efficiency </td>
        <td><span id="NH">0</span></td>
      </tr>
      <tr>
        <td>Open water efficiency  </td>
        <td><span id="No">0</span></td>
      </tr>
      <tr>
        <td>Thrust factor</td>
        <td><span id="thrustFactor">0</span></td>
      </tr>
      <tr>
        <td>advance propeller speed </td>
        <td><span id="Va">0</span></td>
      </tr>
      <tr>
        <td>propeller speed rps </td>
        <td><span id="propeller_speed">0</span></td>
      </tr>
      <!-- <tr>
        <td>Thrust loading Cth</td>
        <td><span id="Cth">0</span></td>
      </tr> -->
      <tr>
        <td>Thrust T</td>
        <td><span id="thrust">0</span></td>
      </tr>
      <tr>
        <td>Thrust Power</td>
        <td><span id="thrustP">0</span></td>
      </tr>
    <tr>
        <td> Power delivered to propeller </td>
        <td><span id="Pd">0</span></td>
      </tr>
     <tr>
        <td>Effective power </td>
        <td><span id="Pe">0</span></td>
      </tr>
      <tr>
        <td>Break  Power: Calm water </td>
        <td><span id="pb_calm">0</span></td>
      </tr>
      <tr>
        <td>Break Power: extrem condition </td>
        <td><span id="pb">0</span></td>
      </tr>
      <!-- <tr>
      <td>SMCR  Power </td>
      <td><span id="smcr">0</span></td>
    </tr>  -->
    </table>
  </div>
   </div>
</div>

    <div class="prop_system">
    <div class= >
       <h2> Propulsion System </h2>
      <form class="propulsion_type" onchange="dispProSystem(event)">
       <span>mechanical Propulsion</span> <input type="radio" name="Propulsion" id="ME_pro" value="ME">
        <span>Diesel Electric Propulsion</span> <input type="radio" name="Propulsion"id="DE_pro" value="DE">
       <!-- <span>Hybrid DE and ME</span><input type="radio" name="Propulsion" id="DE_ME_pro" value="DE_ME"> -->
        <span>Hybrid: DE and battery</span><input type="radio" name="Propulsion" id="DE_Bat_pro" value="DE_Battery" >
        <span>Battery Electric </span><input type="radio" name="Propulsion" id="battery_E" value="battery_E" >
      </form>
   </div>
        <div class="powerSource column" id="powerSource" >
        <div class="engine_source">

            <strong><p class="center">choose engine model</p></strong>
          <select class="engine" onchange="displayEngineType(event)" id="engine_select">
           <option value="" selected><strong>Choose engine</strong> </option>
           <!-- <option value="kongsberg">Kongsberg</option> -->
           <option value="wartsila 32">Wartsila 32</option>
           <option value="wartsila 46F">Wartsila 46F</option>
           <!-- <option value=""></option>
           <option value=""></option> -->
           </select>
          </div>
         <div class="battery_source" >
           <strong><p class="center">Choose Battery model </p></strong>
           <select class="battery" onchange="displayBatteryType(event)" id="battery_select">
            <option value="" selected><strong> choose Battery pack </strong> </option>
            <!-- <option value="kongsberg">Kongsberg</option> -->
            <option value="Orca_Energy">corvus Orca Engergy </option>
            <option value="Blue_Whale">Corvus Blue Whale</option>
             <option value="battery_sizing">new battery dimensioning</option>
            <!-- <option value=""></option>  -->
            </select>
          </div>

          <div class="GenSet_source" >
            <strong><p class="center">Choose Generator set </p></strong>
            <select class="genset" onchange="displayGenSetType(event)" id="genset_select">

             <option value="" selected><strong> Choose Genset  </strong> </option>
             <!-- <option value="kongsberg">Kongsberg</option> -->
             <option value="Wärtsilä_34DF">Wärtsilä 34DF  </option>
             <option value="Wärtsilä_31DF">Wärtsilä 31DF</option>

             </select>
           </div>

           <div class="disp_sim_envirnmt" onchange="display_sim(event)">
             <span><input type="checkbox" name="" id="sim_check"><strong>Open simulation</strong> </span> <br><br>
             <span><input type="radio" name="use_result" id="use_result" checked ><strong>Use calculated result</strong></span> <br>
             <span><input type="radio" name="use_result" id="define_result"><strong>Define new propulsion power</strong></span> <br>
           </div>
        </div>
       </div>
       <div class="battery_sizing hide" id="battery_sizing"  >
        <div class="sizing_info">
              <H3>Tips for sizing </H3>
              <ul>
                <li>DNV-GL requires two seperate battery pack for <br> battery only system</li>
                <li>3 C rate or less is a typical reconmended for <br> a better life span  </li>

              </ul>
        </div>
         <div class="sizing_input" onchange="battery_sizing(event)" >
            <span>max power kW : </span>  <input type="text" name="" id="max_power" required><br><br>
            <span> max_time munites </span>  <input type="text" id="max_time" required><br><br>
            <span>DOD </span> <input type="text" id="size_DOD" required><br><br>
            <span>C rate </span>  <input type="text" id="size_c_rate" required> <br><br>
            <span>C rate peak </span> <input type="text" id="size_c_rate_peak"><br><br>
            <span>Life span </span> <input type="text" id="life_span"><br><br>
         </div>
         <div class="size_result">
            <span>battery min capacity : </span> <span id="size_capacity" class="" ></span><br><br>
            <span>C rate  : </span> <span id="size_result_crate"></span><br> <br>
            <span>C rate peak : </span> <span id="size_result_crate_peak"></span><br> <br>
            <span>SOC : </span> <span id="size_result_SOC"></span><br><br>
            <span>cont discharge/charge power  : </span> <span id="cont_dischargeCharge"></span><br> <br>
            <span>peak discharge/charge power : </span> <span id="cont_dischargeCharge_peak"></span><br><br>
         </div>
       </div>
        <div class="sim_environment hide" id="sim_environment">
              <h3 class="center">Simulation inputs and parameters configuration</h3>
          <form name="myform" onsubmit="preview(event)" id="view_data">
           <div class="simulation " id="simulation" >
              <div class="profile" id="profile" onchange="sim_data(event)">
                <strong><span>Ship/Vessel Operation</span></strong> <br> <br>
                 <span> <input type="checkbox" name="" id="transit" value="operation" >Transit : </span>
                 <span class="transit hide" id="transit_span">Voyage nautical mile <input type="text"  name="" class="sim" id="transit_dis">
                </span>
                <br><br>
                 <!-- <span>  <input type="checkbox" name="" id="standby" value="operation">Stand by : </span>
                 <span id="standby_time_span" class="hide"> time (Hr)<input type="text" name="" class="sim" id="standby_time"></span>
                 <br><br> -->
                 <span>  <input type="checkbox" name="" id="DP" value="operation">DP operation :</span>
                 <span id="DP_time_span" class="hide"> Operation time (Hr)<input type="text" name="" class="sim" id="DP_time"></span>
                 <br><br>
                 <!-- <span>  <input type="checkbox" name="" id="harbor" value="operation">Harbor : </span>
                 <span id="harbor_time_span" class="hide"> time (Hr)<input type="text" name="" class="sim" id="harbor_time"></span>
                 <br><br> -->
              </div>
              <div onchange="sim_data(event)">
                <strong><span>Simulation environment </span></strong><br><br>
                <span> <input type="checkbox" name="" id="calm_sim">  Calm water</span><br><br>
                <span>  <input type="checkbox" name="" id="None_calm_sim"> None Calm water </span><br><br>
                <span class="wave hide" id="wave"><span>max significant Wave height (m) : </span><input type="text" name="" id="wave_height" class="sim">
                <br><br></span>
                <span>Simulation time (minutes) <input type="text" name="" class="sim" id="sim_time"></span>
              </div>
                <div class="load_profile" onchange="sim_data(event)">
                  <strong><span>Load Profile : </span></strong><br><br>
                     <span>Auxiliary Load kW : <input type="text" name="" id="aux_load_input" class="sim"></span>
                     <span id="aux_load_disp"></span><br><br>
                     <span id="propulsion_input" class="">Propulsion Load kW<input type="text" name="" id="main_load" class="sim"></span>
                     <span id="main_load_load_disp"></span><br><br>
                     <span><input type="submit" value="preview selected data " class="view_data" id="viewdata"></span>
                </div>
              </div>
                <!-- <div class="start_sim_main center" >
                  <span><input type="submit" value="Start Simulation" class="start_sim" id="start_sim" disabled></span>
                   <span></span>
               </div> -->

             <!-- <input type="submit" value="preview selected data " class="view_data" id="view_data"> -->
            </form>
           </div>

         <div class="sellected_disp hide" id="sellected_disp" >
           <h3 class="center"> selected and parameters and input data </h3>
           <div class="sellected_pro">
             <div class="main_pro">
             <strong><span>Main Engine</span></strong><br><br>
             <span>Engine Power: </span> <span id="main_eng_power_dis"></span><br>
             <span>engine RPM: </span> <span id="main_engine_rpm"></span><br>
             <span>N0.of engines: </span> <span id="no_engines"></span><br>
             <span>installed power: </span><span id="main_installed_power"></span> <br>
             <span>Propulsion power :</span> <span id="propulsion_p"></span >
             
            </div>

           <div class="aux_pro">
             <strong><span>Auxiliary Engine</span></strong><br><br>
             <span><strong>Engine Power :</strong> </span> <span id="aux_eng_power_dis"></span><br>
             <span><strong>engine RPM : </strong></span> <span id="aux_engine_rpm"></span><br>
             <span><strong>N0. of engines :</strong> </span> <span id="aux_no_engines"></span><br>
             <span><strong>Auxiliary Load :</strong> </span><span id="aux_load"></span> <br>
             <span><strong>installed power :</strong> </span><span id="aux_installed_power"></span> <br>
           </div>
           <div class="battery_pro">
            <strong><span>Battery pack</span></strong><br><br>
            <span><strong>battery capacity :</strong> </span> <span id="b_capacity"></span><br>
            <span><strong>c_rate: </strong></span> <span id="c_rate"></span><br>
            <span><strong>c_rate peak : </strong></span> <span id="c_rate_peak"></span><br>
            <span><strong>voltage :</strong> </span><span id="volt_pro"></span> <br>
            <span><strong>Charge/discharge power :</strong> </span><span id="charge_power"></span> <br>

            <span><strong>DOD :</strong> </span><span id="DOD_pro"></span> <br>
            <span><strong>SOC</strong> </span><span id="SOC_pro"></span> <br> 
            <span><input type="button" value="Rest soc to 0" class="start_sim" id="rest_soc" onclick="preview(event)" ></span>

           </div>
           <div class="gen_pro">
            <strong><span>General info</span></strong><br><br>
             <strong><span>Propulsion type : </span> </strong> <span id="chose_propulsion"></span><br>
             <strong> <span>Total installed power</span> </strong><span id="Total_inst_power"></span> <br>
             <strong><span>Simulation time : </span ></strong><span id="simulate_time"></span> <br>
             <span><input type="button" value="Start Simulation" class="start_sim" id="start_sim" onclick="preview(event)" ></span>
             <span><input type="button" value="Back" class="start_sim" id="sim_display" onclick="preview(event)" ></span>

           </div>
         </div >
       </div>
       <div class="hide center" id="select_message" >
              <input type="button" value="" id="select_message_butt" class="select_message_butt center"> <br><br>
              <input type="button" value="Test engine performance" id="engine_perf" class="engine_perf" onclick="display_sim(event)">
              <input type="button" value="close" id="close" class="close" onclick="display_sim(event)">
       </div>
         <div  id="engineTable" class=" hide">
              <div class="create_custo_engine hide" id="custom_engine" onclick="displayEngineType(event)">
                <input type="button" value="create customized engine" class="custom_button" id="custom_engine">
              </div>
              <form  onsubmit="displayEngineType(event)"  class="custom">
              <table id="Table" class="Table" onchange="custom_engine_genset(event)">
                <thead>
                  <th colspan="3"></th>
                </thead>
                <tr>
                  <td></td>
                  <td></td>
                </tr>
              </table>
            </form>
      </div>
            <div id="batteryTable" class=" hide">
              <div class="create_custo_bat" onclick="displayBatteryType(event)">
                <input type="button" value="create customized Pack" class="custom_button" id="custom_battery">
              </div>
              <form  onsubmit="displayBatteryType(event)" class="custom">
              <table id="bat_Table" class="bat_Table" onchange="custom_battery_pack(event)" >
                <thead>
                  <th colspan="3"></th>
                </thead>
                <tr>
                  <td></td>
                  <td></td>
                </tr>
              </table>
            </form>
      </div>

      <div  id="gensetTable" class=" hide" >
        <div class="create_custo_genset hide" id="custo_genset" onclick="displayGenSetType(event)">
          <input type="button" value="create customized genset" class="custom_button" id="custom_genset" >
         </div>
        <form onsubmit="displayGenSetType(event)" class="custom" >
        <table id="genset_Table" class="genset_Table" onchange="custom_engine_genset(event)" >
          <thead>
            <th colspan="3"></th>
          </thead>
          <tr>
            <td></td>
            <td></td>
          </tr>
        </table>
      </form>
  </div>
        <div id="mainDashboard" class="mainDashboard hide">

         <div id="engineDashboard" class="grides">
                <div class="power chartDisp" >
                    <p>Engine rated power </p>
                    <div id="powerChart" class="chart"></div>
                </div>
                <div class="torque chartDisp" id="torque">
                    <p>Engine Torque kNm</p>
                    <div id="torqueChart" class="chart"></div>
                </div>
                <div class="RPM chartDisp" id="RPM">
                    <p>Engine Speed RPM</p>
                    <div id="RPMchart" class="chart"></div>
                </div>
                <div class="load chartDisp" >
                <p>Engine load in %</p>
                    <div id="loadChart" class="chart">
                </div>
            </div>
                <div class="loadwatt chartDisp" id="loadwatt">
                    <p>Engine load kW</p>
                    <div id="loadWattChart" class="chart"></div>
                </div>
                <div class="SFOC_chart chartDisp" id="SFOC_chart">
                    <p> current SFOC </p>
                    <div id="sfocChart" class="chart"></div>
              </div>
            </div>
        <div class="dashboardControl">

            <!-- parameters control and configuration  -->
            <div class="engineInput">
              <h2> Test engine performance </h2>
              <h3 class="center">using below paramters</h3>

              <form  id="simple_form" class="form">

              <p class="P_range testing" >Speed RPM : <input type="range" step="10" id="RPM" class="range" onchange= "getValues(event)"  oninput="myFunction(this.value)"> or
               <input type="text" placeholder="input engine speed.." onchange="getValues(event)"  id="RPMInput"><span class="inputValue"id="displayRPM"> </span><br> </p>

               <p class="P_range">Load %: <input type="range" max="98" min="10"id="load" class="range" step="2" onchange="getValues(event)"oninput="loadSfoc(this.value)" > or
             <input type="text" placeholder="input engine load %.." onchange="getValues(event)"  id="loadInput"><span  class="inputValue" id="loadDisplay"> </span><br> </p>

              <p class="P_range" >Desired Power kW: <input type="range" step="2" id="power" class="range" onchange="getValues(event)" oninput="powerSfoc(this.value)" > or
               <input type="text" placeholder="input Power.."onchange="getValues(event)"  id="powerInput">
              <span  class="powerDisplay" id="powerDisplay"> </span> </p>

              </form>
              <div onclick="powerOn(event)" >
                <button class="powerOn" id="powerOn"><strong>Power On Engine </strong></button>
                <input type="button" value="Done" class="done" id="done">
              </div>

          </div>
          </div>
        </div>
              <!-- grapph ploting here -->
         <div class="SFOC" id="SFOC">
             <div id="plot" class="plot">
               
             </div>
             
         </div>
         <div class="darshboard_container hide" id="darshboard_container">
        <div class="sim_ploting">
          <div class="darshboard_engines section" >
          <div class="section" id="result_darshboard_main">
             <div class="darsh_top center" > <span>Propulsion system</span></div>
             <span class="span_result "><span id="main_install_darsh" class="live_data"></span> <br>Power kW</span>
            <span class="span_result"> <span id="main_load_darsh" class="live_data" > </span> <br> load kW </span> <br>
             <span class="span_result">  <span id="main_no_engines_darsh" class="live_data"> </span> <br> engines</span>
             <span class="span_result">  <span id="main_active_engine_darsh" class="live_data"> </span> <br> Active engine</span> <br>
            <span class="span_result">  <span id="main_FC_darsh" class="live_data"></span> <br>FC tons</span>
            <span class="span_result">  <span id="main_sfoc_darsh" class="live_data"></span> <br>sfoc g/kWh</span> <br>
          </div>
          <div class="section" id="result_darshboard_Aux">
              <div class="darsh_top center"><span> Auxiliary system</span> </div> <br>
              <div>
                  <span class="span_result">  <span id="aux_install_darsh" class="live_data"> </span> <br> power kW</span>
                  <span class="span_result">  <span id="aux_load_darsh" class="live_data"> </span  > <br> Load kW </span> <br>
                  <span class="span_result">   <span id="aux_no_engines_darsh" class="live_data"></span> <br> engines</span>
                  <span class="span_result">  <span id="aux_active_engine_darsh" class="live_data"> </span> <br> active engines </span> <br>
                  <span class="span_result">  <span id="aux_FC_darsh"  class="live_data"> </span> <br> FC tons</span>
                  <span class="span_result">  <span id="aux_sfoc_darsh" class="live_data"> </span> <br> sfoc g/kWh</span> <br>
            </div>
          </div>
         </div>

        <div class="battandemiss section" >
          <!-- //battery and emission section  -->
          <div class="section" id="">
            <div class="darsh_top center"><span>Battery pack</span></div>
            <span class="span_result"> <span id="capacity_darsh" class="live_data"> </span > <br>Capacity kWh </span>
            <span class="span_result">  <span id="soc_darsh" class="live_data"></span > <br>SOC kWh</span> <br>
            <span class="span_result">  <span id="c_rate_darsh" class="live_data"></span > <br>C rate</span>
            <span class="span_result">  <span id="c_rate_peak_darsh" class="live_data"></span > <br>C peak</span>
            <span class="span_result"> <span id="DOD_darsh" class="live_data"></span > <br>DOD </span> <br>
          </div>
           <div class="section">
            <div class="darsh_top center"><span>Emissions Chart</span></div>
            <div class="emission" id="emission">
              <canvas id="emission_chart"></canvas>

               <br>
            </div>
           </div>
           <div class="general section ">
            <div>
              <span class="span_disp span_result">  <span id="ETA" class="live_data"></span > <br> ETA </span>
              <span class="span_disp span_result"> <span id="speed_show" class="live_data"></span > <br> Speed Knt </span>
              <span class="span_disp span_result">  <span id="wave_height_show" class="live_data"></span > <br> wave heingt</span>
              <span class="span_disp span_result"> <span id="distance_Mils" class="live_data"></span ><br> Nautical Mils </span>

            </div>
          </div>
        </div>

        <div class="sim_update section">
          <div class="update section" >
            <div class="darsh_top center" id="update_top"> <span>Update parameter</span></div>
            <div class="center">
           <span> Adjust speed <input type="range" name=""min="1" max="26" step="0.5" id="update_shipSpeed" onchange="update_simulation_data(event)"></span> <span id="update_shipSpeed_show"></span> <br><br>
           <span>wave
            <input type="checkbox" name="" id="wave_check" onchange="update_simulation_data(event)">
           <span>max Wave height (m) : </span ><input type="text" name="" id="wave_height_update" class="sim" onchange="update_simulation_data(event)">    <span class="" id="wave_update"></span>
          </span> <br>
          <span>Speed
            <input type="checkbox" name="" id="speed_check" onchange="update_simulation_data(event)">
           <span>max wind speed (m/s) : </span ><input type="text" name="" id="wind_speed_update" class="sim" onchange="update_simulation_data(event)">    <span class="" id="wind_update"></span>
          </span> <br>
          <span class="span_disp"> adjust hotel load <input type="range" name="" min="1000" max="15000" step="500" id="adjust_load" onchange="update_simulation_data(event)"></span> <span id="adjust_load_show"></span> <br><br>
          </div>
            </div>
          <div class=" section" id="">
            <div id="result" class="result">
             <span>Switch to different data</span> 
              <select name="" id="online_engine_power" onchange="switch_displayed_data(event)"> 
                <option value="General_powers">General engines</option>
                <option value="engine_set1"> Engine set 1</option>
                <option value="engine_set2"> Engine set 2</option>
                <option value="genset_engine"> Genset Engine</option>
                <option value="engine_set1_set2"> Engine set2 VS set1</option>
                <option value="mian_engine"> main  engine </option>
                <option value="mian_genset_engine"> main & genset engine </option>
                <!-- <option value="engine_3"> Engine 3</option>
                <option value="engine_4"> Engine 4</option>
                <option value="engine_5"> Engine 5</option> -->
                <option value="battery"> battery </option>
              </select>
              <br>
              <br>
            </div>
          </div>
          <div class="center result_button"  onclick="compare_result(event)"><input type="button" value="check other result " id="other_result"></div>
         </div>
      </div>
   </div>
 
    <button id="dashboard_downlaod" onclick="dashboard_download(event)">Download dashboard</button>

    </div>
    <div class="result_compare hide" id="result_compare" onclick="compare_result(event)">
      <span class="insight_header"> <strong>Operational data insights for different engines and fuels  </strong> </span> 
      <div class="center result_button">
        <span class=""><strong> </strong></span><br><br>
         <span class="hide change_fuel" id="change_fuel">
           <span><strong>change fuel </strong>: </span>
           <select name="" id="fuel_compare_type" onchange="compare_result(event)">
             <option value="LNG" selected>LNG</option>
             <option value="MGO">MGO</option>
             <option value="MDO">MDO</option>
             <option value="HFO">HFO</option>   
           </select>
         </span>
        <span><input type="button" value="emission" id="show_emission"></span>
        <span><input type="button" value=" fuel Cost" id="show_cost"></span>
        <!-- <span><input type="button" value="fuel volume" id="show_volume"></span> -->
        <span><input type="button" value=" fuel ton" id="show_FC"></span>
        <span><input type="button" value="show darshboard" id="show_dasrhboard"></span>
      </div>
     <div class="result_canvas" id="result_canvas">
       <canvas id="comparison_chart"></canvas>
     </div>
    </div>

    <!-- <div class="addedMachinery">
      <h2>The chose machinery will be dispplay here  </h2>
       <div class="ship_move" id="ship_move">
        <img src="https://images.pexels.com/photos/1556991/pexels-photo-1556991.jpeg?auto=compress&cs=tinysrgb&h=750&w=1260" alt=" Ship simulation" class="img_display">

       </div>

    </div> -->

   <br>
   <br>

    <script>


 // Major constant
 viscosity = 0.0000012 // m/s^2
 g = 9.81  // m/s^2
 density = 1000 // kg/m^3
 density_air = 1.225

 resistanceDisplay ()

 function resistanceDisplay (){


var resistance = {
  type: 'scatter',
  x: [],
  y: [],
}

var resistData = [ resistance ]
var layout = {

  xaxis:
	{
        range: [0, 30],
        showgrid: false,
        title: 'Ship speed in knots'
    },
    yaxis:{
        showgrid: false,
        range: [],
        title: 'kN'

    },
    title: 'Resistance curve  ',

//   plot_bgcolor: 'yellow',
  // width:600,
  // height:600,
//   paper_bgcolor: 'purple'


};
const config = {responsive: true}
Plotly.newPlot('resistanceGraph',resistData,layout,config);



}


function sfocDisplay (){
  const main_sfoc = {
  type: 'scatter',
  x: [],
  y: [],
  name: "Main engine SFOC",
}
const Aux_sfoc = {
  type: 'scatter',
  x: [],
  y: [],
  name: "Auxiliary engine SFOC",
}

// //   plot_bgcolor: 'yellow',
//   width:600,
//   height:400,
// //   paper_bgcolor: 'purple'
const datas = [ main_sfoc, Aux_sfoc]
const layout = {

  xaxis:
	{
        range: [0, 100],
        showgrid: false,
        title: 'engine load in %',
        rangemode:"tozero",
    },
    yaxis:{
        showgrid: false,
          range: [150,220],
        rangemode:"tozero",
        title: 'SFOC'
    },
   title: 'Live SFOC Vs engine load % ',
//   plot_bgcolor: 'yellow',
  // width:600,
  // height:600,
//   paper_bgcolor: 'purple'

  };
  const config = {responsive: true}


  Plotly.newPlot('plot',datas,layout,config);

}

function LiveResult(){

let load_data = {
  type: 'scatter',
  x: [],
  y: [],
}
const data1 = Object.create(load_data)
const data2 = Object.create(load_data)
const data3 = Object.create(load_data)
const data4 = Object.create(load_data)
const data5 = Object.create(load_data)
const data6 = Object.create(load_data)
const data7 = Object.create(load_data)
const data8 = Object.create(load_data)
const data9 = Object.create(load_data)
const data10 = Object.create(load_data)
const data11 = Object.create(load_data)
const data12 = Object.create(load_data)


// //   plot_bgcolor: 'yellow',
//   width:600,
//   height:400,
// //   paper_bgcolor: 'purple'
const datas = [data1,data2,data3,data4,data5,data6,data7,data8,data9,data10,data11,data12]
//const datas = [auxLoad,mainLoad,mainPower,initialize_space]

const layout = {
  //autosize: true,
  font: {
    family: 'Courier New, monospace',
    size: 16,
    color: '#3bc140'
  },
  legend: {
    x: 0.5,
    xanchor: 'center',
    y: 1
  },
  xaxis:
	{
        showgrid: false,
        title: 'time millisecond',
        rangemode:"tozero",
    },
    yaxis:{
        showgrid: false,
        // range: [100, 220],
         rangemode:"tozero",
        title: 'Power kW '
    },
   title: 'Energy/power monitor  ',
   plot_bgcolor: '#3b1c50',

   paper_bgcolor: '#072b39'

  };
  const config = {responsive: true}

  Plotly.newPlot('result',datas,layout,config);

}
let myChart
emission()
function emission(){
  const ctx = document.getElementById('emission_chart');
   myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['CO2', 'SOX', 'NOx', 'NMVOC', 'PM'],
        datasets: [{
            label: 'Main engines',
            data: [],
            backgroundColor:  'rgba(75, 192, 192, 0.2)',
            borderColor:'rgba(255, 159, 64, 1)',
            borderWidth: 1,
        },
           {
            label: 'Auxilairy engine',
            data: [],
            backgroundColor:  'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgba(255, 159, 64, 1)',
            borderWidth: 2,

        }]
    },
    options: {
      tooltips:{
      mode: 'index',
      },
      legend:{
        position: 'bottom',
        align: 'center',
        labels: {
                text: "",
                fontColor: 'rgb(255, 99, 132)'
            },
      },
      title:{
        display: true,
        //  text: 'emission '
       },
        scales: {
            yAxes: [{
              scaleLabel:{
                    display: true,
                    labelString: 'tons',
                    fontColor: '#3bc140'
                 },
                ticks: {
                    beginAtZero: true,
                    fontColor:'#3bc140',
                    callback: function(value, index, values) {
                        return  value;
                    }
                }
            }]
        }
    }
});

}
fuel_comparison()
function fuel_comparison(){
   const ctx = document.getElementById('comparison_chart');
   emission_comparison = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: [],
        datasets: [{
            label: 'Main engine',
            data: [],
            backgroundColor: 'rgba(164, 62, 223, 1)',
            borderColor:'rgba(255, 159, 64, 1)',
            borderWidth: 2
        },
           {
            label: 'Auxiliary engine',
            data: [],
            backgroundColor:  'rgba(164, 223, 62, 1)',
            borderColor: 'rgba(55, 67, 64, 1)',
            borderWidth: 2
        },
 
        ]
    },
    options: {
      responsive:true,
      tooltips:{
      mode: 'index',
      },
      legend:{
        position: 'bottom',
        align: 'center',
      },
      title:{  
        display: true,
         text: 'Alternative Fuel comparison ',
         fontColor: 'rgb(255, 9, 132)',
          fontSize: 23
       },
        scales: {
            yAxes: [{
              scaleLabel:{
                    display: true,
                    labelString: 'Tonnes',
                    fontColor:'#3bc140',
                 },
                ticks: {
                    beginAtZero: true,
                    fontColor:'#3bc140',
                    callback: function(value, index, values) {
                        return '' + value;
                    }
                }
            }]
        }
    }
 });

}

function powerDisplay (){

var chart = c3.generate({

    bindto: '#powerChart',

    data: {
        columns: [
            ['Engine power', enginePower*0.01]
        ],
        type: 'gauge',
        onclick: function (d, i) { console.log("onclick", d, i); },
        onmouseover: function (d, i) { console.log("onmouseover", d, i); },
        onmouseout: function (d, i) { console.log("onmouseout", d, i); }
    },

    gauge: {
      label: {
          format: function(value, ratio) {
              return value;
          },
          show: true // to turn off the min/max labels.
        },
    min: 0, // 0 is default, //can handle negative min e.g. vacuum / voltage / current flow / rate of change
    max: enginePower, // 100 is default
    units: '  kW',
    width: 39 // for adjusting arc thickness

    },

    color: {
        pattern: ['#FF0000', '#F97600', '#F6C600', '#60B044'], // the three color levels for the percentage values.
        threshold: {
//            unit: 'value', // percentage is default
//            max: 200, // 100 is default
            values: [enginePower*0.25, enginePower*0.33, enginePower*0.6, enginePower]
        },

    },
    size: {
        height: 150
    }
});

setTimeout(function () {
    chart.load({
        columns: [['Engine power', enginePower*0.1]]
    });
}, 1000);

setTimeout(function () {
    chart.load({
        columns: [['Engine power', enginePower*0.5]]
    });
}, 2000);

setTimeout(function () {
    chart.load({
        columns: [['Engine power', enginePower]]
    });
}, 3000);
}

function torqueDisplay (){
    let torqueMax,i
    i = 10
    console.log("torque",torque)
    console.log("torque max")
    torqueMax = i+torque

var chart1 = c3.generate({

  bindto: '#torqueChart',

  data: {
      columns: [
          ['Torque', 10]
      ],

      type: 'gauge',
      onclick: function (d, i) { console.log("onclick", d, i); },
      onmouseover: function (d, i) { console.log("onmouseover", d, i); },
      onmouseout: function (d, i) { console.log("onmouseout", d, i); }
  },
  gauge: {
      label: {
          format: function(value, ratio) {
              return value;
          },
          show: true // to turn off the min/max labels.
      },
  min: 0, // 0 is default, //can handle negative min e.g. vacuum / voltage / current flow / rate of change
  max: torqueMax, // 100 is default
 units: ' kNm',
  width: 39 // for adjusting arc thickness

  },

  color: {
      pattern: ['#FF0000','#F43500', '#b2d2c2'], // the three color levels for the percentage values.
      threshold: {
//            unit: 'value', // percentage is default
        //   max: (200), // 100 is default
          values: [torque/3,torque/2, torque ]
      },

  },
  size: {
      height: 150
  }
});

setTimeout(function () {
    chart1.load({
        columns: [['Torque', torque/3]]
    });
}, 5000);

setTimeout(function () {
    chart1.load({
        columns: [['Torque', torque/2]]
    });
}, 7000);
setTimeout(function () {
    chart1.load({
        columns: [['Torque', torque]]
    });
}, 9000);


}

function rpmDisplay(){
  let rotating_speed = speedRPM
    if(RPM){
      rotating_speed = RPM
    }else{
      if(!speedRPM){
        rotating_speed = ratedSpeed
      }
    }
    var chart2 = c3.generate({

    bindto: '#RPMchart',

    data: {
        columns: [
            ['Speed', rotating_speed]
        ],
        type: 'gauge',
        onclick: function (d, i) { console.log("onclick", d, i); },
        onmouseover: function (d, i) { console.log("onmouseover", d, i); },
        onmouseout: function (d, i) { console.log("onmouseout", d, i); }
    },
    gauge: {
      label: {
          format: function(value, ratio) {
              return value;
          },
          show: true // to turn off the min/max labels.
      },
  min: 0, // 0 is default, //can handle negative min e.g. vacuum / voltage / current flow / rate of change
  max: ratedSpeed, // 100 is default
 units: '  rpm',
  width: 39 // for adjusting arc thickness

  },

    color: {
        pattern: ['#FF0000', '#F97600', '#F6C600', '#60B044'], // the three color levels for the percentage values.
        threshold: {
//            unit: 'value', // percentage is default
//            max: 200, // 100 is default
            values: [rotating_speed*0.25, rotating_speed*0.5, rotating_speed*0.7, rotating_speed]
        }
    },
    size: {
        height: 150
    }
});

setTimeout(function () {
    chart2.load({
        columns: [['Speed', rotating_speed*0.01]]
    });
}, 1000);

setTimeout(function () {
    chart2.load({
        columns: [['Speed', rotating_speed*0.3]]
    });
}, 2000);

setTimeout(function () {
    chart2.load({
        columns: [['Speed', rotating_speed*0.7]]
    });
}, 3000);

setTimeout(function () {
    chart2.load({
        columns: [['Speed', rotating_speed]]
    });
}, 5000);

}

function loadDisplay(){
    if(!engine_loadPercent){
        engine_loadPercent = 0
    }
var chart4 = c3.generate({

  bindto: '#loadChart',

  data: {
      columns: [
          ['Load', engine_loadPercent]
      ],
      type: 'gauge',
      onclick: function (d, i) { console.log("onclick", d, i); },
      onmouseover: function (d, i) { console.log("onmouseover", d, i); },
      onmouseout: function (d, i) { console.log("onmouseout", d, i); }
  },
  gauge: {
      label: {
          format: function(value, ratio) {
              return value;
          },
          show: true // to turn off the min/max labels.
      },
  min: 0, // 0 is default, //can handle negative min e.g. vacuum / voltage / current flow / rate of change
  max: 100, // 100 is default
 units: ' %',
  width: 39 // for adjusting arc thickness

  },

  color: {
      pattern: ['#FF0000', '#FF0000', '#FF0000', '#FF0000', '#FF0000'], // the three color levels for the percentage values.
      threshold: {
//            unit: 'value', // percentage is default
          // max: 200, // 100 is default
          values: [20, 40, 60, 80, 100]
      }
  },
  size: {
      height: 150
  }
});

if(load){
setTimeout(function () {
  chart4.load({
      columns: [['Load',engine_loadPercent]]
  });
}, 1000);

}

// setTimeout(function () {

// }, 6000);
// let k = sfoc_cal

    var interval = setInterval(function() {

        chart4.load({
          columns: [['Load', engine_loadPercent]]
      });

      }, 1000);
//  if( > 10) clearInterval(interval);

 ;

}

function loadWattDisplay (){
    if(!load){
        load = 0
    }

var chart3 = c3.generate({


  bindto: '#loadWattChart',

  data: {
      columns: [
          ['engine load', ratedPower*1]
      ],

      type: 'gauge',
      onclick: function (d, i) { console.log("onclick", d, i); },
      onmouseover: function (d, i) { console.log("onmouseover", d, i); },
      onmouseout: function (d, i) { console.log("onmouseout", d, i); }
  },
  gauge: {
      label: {
          format: function(value, ratio) {
              return value;
          },
          show: true // to turn off the min/max labels.
      },
  min: 0, // 0 is default, //can handle negative min e.g. vacuum / voltage / current flow / rate of change
  max: ratedPower*1, // 100 is default
 units: '  kW',
  width: 39 // for adjusting arc thickness

  },

  color: {
      pattern: ['#F97600','#F97600', '#F97600' ,'#F97600'], // the three color levels for the percentage values.
      threshold: {
//            unit: 'value', // percentage is default
          // max: 200, // 100 is default g
          values: [load*0.25, load*0.5, load*0.8, load*0.9]
      }
  },
  size: {
      height: 150
  }
});
var interval = setInterval(function() {

chart3.load({
  columns: [['engine load',load]]
});

// if( > 10) clearInterval(interval);
}, 100);

setTimeout(function () {
  chart3.load({
      columns: [['engine load', load]]
  });
}, 2000)

}
let sfoc_display
function currentSfocDisplay (){
    
    if(recent_chose_engine ==="aux_engine"){
      if(!sfoc_display){
        sfoc_display = aux_ratedsfoc      
      }
    
    }else{
      
        if(!sfoc_display){
          sfoc_display = ratedSfoc;
        }
    }
    var chart4 = c3.generate({
      bindto: '#sfocChart',
      data: {
          columns: [
              ['sfoc', sfoc_display]
          ],
          type: 'gauge',
          onclick: function (d, i) { console.log("onclick", d, i); },
          onmouseover: function (d, i) { console.log("onmouseover", d, i); },
          onmouseout: function (d, i) { console.log("onmouseout", d, i); }
      },
      gauge: {
          label: {
              format: function(value, ratio) {
                  return value;
              },
              show: true // to turn off the min/max labels.
          },
      min: 0, // 0 is default, //can handle negative min e.g. vacuum / voltage / current flow / rate of change
      max: 220, // 100 is default
     units: '  g/kWh',
      width: 39 // for adjusting arc thickness

      },

      color: {
          pattern: ['#FF0000','#F97600','#60B044'], // the three color levels for the percentage values.
          threshold: {
    //            unit: 'value', // percentage is default
              // max: 200, // 100 is default g
              values: [160, 179,184]
          }
      },
      size: {
          height: 150
      }
    });

    var interval = setInterval(function() {
        chart4.load({
          columns: [['sfoc', sfoc_display]]
      });
        // if( > 10) clearInterval(interval);
      }, 100);
    }
    let x = 0

 function appendageCal(event){
         let BKA,SkegCheck, RBSCheck,RBSkegCheck,hullBossings,thrustersCheck,thrustersNO,thrusterD, bulbousCkeck,
         StaFinsVal, bKeelVal,domeCheckVal, sBracketVal,sBossingsVal,shaftsCheckVal,RBS,RBStern,
       Skeg,RBSArea,RBSternArea,SkegArea,shafts,hullBossingsVal,
        s1, s2, s3, s4, s5, s6, s7, s8, s9, s10,k2_1,k2_2,k2_3,k2_4,k2_5,k2_6,k2_7,k2_8,k2_9, k2_10,i
        i = 0

         bulbousCkeck = document.getElementById("bulbous").checked
         roughness = document.getElementById("Roughness").checked

         RBSkegCheck = document.getElementById("rudderBehindSkegCheck").checked
         RBSCheck = document.getElementById("rudderBehindSternCheck").checked
         SkegCheck = document.getElementById("SkegCheck").checked
         domeCheck = document.getElementById("DomeAreaCheck").checked
         StaFins = document.getElementById("StabilizerFinsCheck").checked
          shaftsCheck = document.getElementById("ShaftsCheck").checked
         sBossings = document.getElementById("StrutBossingsAreaCheck").checked
         sBracket = document.getElementById("ShaftBracketAreaCheck").checked
         bKeel = document.getElementById("BilgeKeelAreaCheck").checked
         hullBossings = document.getElementById("hullbossingCheck").checked
         thrustersCheck = document.getElementById("thrustercheck").checked

         RBSArea= document.getElementById('ArearudderBehindSkeg').value
         RBSArea = parseFloat(RBSArea)
         RBSternArea= document.getElementById('rudderBehindSternArea').value
         RBSternArea = parseFloat(RBSternArea)
         SkegArea= document.getElementById('SkegArea').value
         SkegArea = parseFloat(SkegArea)
         domeCheckVal = document.getElementById('DomeArea').value
         domeCheckVal = parseFloat(domeCheckVal)
         StaFinsVal = document.getElementById('StabilizerFins').value
         StaFinsVal = parseFloat(StaFinsVal)
          shaftsCheckVal = document.getElementById('ShaftsArea').value
          shaftsCheckVal = parseFloat(shaftsCheckVal)
         bKeelVal = document.getElementById('BilgeKeelArea').value
         bKeelVal = parseFloat(bKeelVal)
         sBracketVal = document.getElementById('ShaftBracketArea').value
         sBracketVal = parseFloat(sBracketVal)
         hullBossingsVal = document.getElementById('hullBossings').value
         hullBossingsVal = parseFloat(hullBossingsVal)
         sBossingsVal = document.getElementById('StrutBossingsArea').value
         sBossingsVal = parseFloat(sBossingsVal)


         thrusterD = document.getElementById('thrusterDiameter').value
         thrusterD = parseFloat(thrusterD)
        thrustersNO = document.getElementById('thrusterNO').value
  //  document.getElementById('displaythrusterDiameter').innerHTML= thrusterD + " m"
  // document.getElementById('displaythrusterNO').innerHTML= thrustersNO


     RBS= document.getElementById('rudderBehindSkeg').value
     RBS = parseFloat(RBS)
  // document.getElementById('displayRudderBehindSkeg').innerHTML=RBS +" "
  // document.getElementById('RudderBehindSkegArea').innerHTML= RBSArea + " m^2"

  RBStern= document.getElementById('rudderBehindStern').value
  RBStern = parseFloat(RBStern)
//   document.getElementById('displayRudderBehindStern').innerHTML= RBStern +" "
//  document.getElementById('AreaRudderBehindStern').innerHTML= RBSternArea

  Skeg= document.getElementById('Skeg').value
  Skeg = parseFloat(Skeg)
  // document.getElementById('displaySkeg').innerHTML= Skeg +" "
  // document.getElementById('displaySkegArea').innerHTML= SkegArea

  // document.getElementById('displayShaftsArea').innerHTML= shaftsCheckVal
  shafts = document.getElementById('Shafts').value
  shafts = parseFloat(shafts)
  // document.getElementById('displayShafts').innerHTML= shafts

        //  let s1, s2, s3, s4, s5, s6, s7, s8, s9, s10,Sapp
        //  s1 to to s10 represent the weted area of the individual appenadge
        //  Sappp  is the total wtted of all the appendages

        if(RBSkegCheck=== true && RBSArea > 0){
         RBS= document.getElementById('rudderBehindSkeg').value
         RBS = parseFloat(RBS)
         k2_1 = (RBSArea * RBS)/RBSArea
         s1 = RBSArea *1
         i = 1
        }else{
            k2_1  = 0
            s1 = 0
        }
        if(RBSCheck=== true && RBSternArea > 0){
            RBStern= document.getElementById('rudderBehindStern').value
            RBStern = parseFloat(RBStern)
            k2_2 = (RBSternArea * RBStern)/RBSternArea
            s2 = RBSternArea*1
            i = 1
        }else{
            k2_2 =0
            s2 = 0
        }

        if(SkegCheck===true && SkegArea > 0){
          Skeg= document.getElementById('Skeg').value
           Skeg = parseFloat(Skeg)
            k2_3 = (SkegArea * Skeg)/SkegArea
            s3 = SkegArea*1
            i = 1
        }else{
            k2_3 =0
            s3 = 0
        }
        if(domeCheck===true && domeCheckVal > 0){
            //Dome
            k2_4 = (2.7* domeCheckVal)/domeCheckVal
            s4 = domeCheckVal*1
            i = 1
        }else{
            k2_4 = 0
            s4 =0
        }
        if(StaFins === true && StaFinsVal > 0){
            k2_5 = (2.8 * StaFinsVal)/StaFinsVal
            s5 = StaFinsVal*1
            i = 1
        }else{
            k2_5 = 0
            s5 = 0
        }
        if(shaftsCheck === true && shaftsCheckVal > 0 ){
            shafts = document.getElementById('Shafts').value
            shafts = parseFloat(shafts)
            k2_6 = (shafts * shaftsCheckVal)/shaftsCheckVal
            s6 = shaftsCheckVal*1
            i = 1
        }else{
            k2_6 = 0
            s6 = 0
        }
        if(bKeel === true && bKeelVal > 0){
            k2_7 = (1.4* bKeelVal)/bKeelVal
            s7 = bKeelVal*1
            i = 1
        }else{
            k2_7 = 0
            s7 = 0
        }
        if(sBossings === true && sBossingsVal > 0){
            k2_8 = (3 * sBossingsVal)/sBossingsVal
            s8 =  sBossingsVal*1
            i = 1
        }else{
            k2_8 = 0
            s8 = 0
        }
        if(sBracket === true && sBracketVal > 0){
            k2_9 = (3* sBracketVal)/sBracketVal
            s9 =  sBracketVal*1
            i = 1
        }else{
            k2_9 = 0
            s9 = 0
        }
        if(hullbossingCheck === true && hullBossingsVal > 0){
            k2_10 = ((2* hullBossingsVal )/hullBossingsVal)*1
            s10 = hullBossingsVal*1
            i = 1
        }else{
            k2_10 = 0
            s10 = 0
        }
        Sapp = s1+s2+s3+s4+s5+s6+s7+s8+s9+s10

        if(Sapp <= 0){

          Sapp = 1
        }

       K2 =  k2_1+k2_2+k2_3+k2_4+k2_5+k2_6+k2_7+k2_8+k2_9+ k2_10
      //
      //Check if thrusters are fitted on the vessel
      if(thrustersCheck=== true){
        // dt means thruster diamter
        thruster = thrustersCheck
         dt = thrusterD * thrustersNO

        i = 1

      }else{
        dt = 0
      }

      //Check if bulbous bow is fitted on the vessel
      if(bulbousCkeck===true){
         bulbous = bulbousCkeck
         i = 1
      }else{
        bulbous = bulbousCkeck
        i = 1
      }


    x++
    if(i >0 || x>=2){
      updateResistance()

    }


     }

 shipDimension(event)
 appendageCal(event)
 sternType()

 function handle_inputs(event){
   // handle all the RRESISTANCE input fields with this fucntion
   let newVal,curentID,oldVal,step,unit,eventVal,eventID,incri_ID
    eventID = event.target.id
    eventVal = event.target.value
   unit = event.target.getAttribute("data-name")
    curentID =  eventID
   curentID = curentID.split("_")//split of the plus or minus id to get the coresponding input ID
   incri_ID =  curentID   //incremental sign adding or substracting
   if(curentID.length >1){
       curentID  =  curentID[0] // this will match every input id that corespond to either minus or plus
      incri_ID = incri_ID[1] // checking the ID to determine if to increase or decrese value
      step = document.getElementById(curentID).step
      oldVal = document.getElementById(curentID).value
      oldVal = parseFloat(oldVal)
      step = parseFloat(step)

      if(incri_ID ==="plus"){
         newVal = oldVal + step

      }
      if(incri_ID ==="minus"){
         newVal = oldVal - step

        }
        newVal = newVal.toFixed(2)
        document.getElementById(curentID).value = newVal + unit
   }else{
     return "value input"
   }

   shipDimension(event)
 }

 function shipDimension(event){

 shipSpeedKnots = document.getElementById('shipSpeed').value
 shipSpeedKnots = parseFloat(shipSpeedKnots)
//  document.getElementById('displayShipSpeed').innerHTML= shipSpeedKnots + " knots"
 shipSpeed = shipSpeedKnots* 0.5144
 Lwl = document.getElementById('Lwl').value
 Lwl = parseFloat(Lwl)
//  document.getElementById('displayLwl').innerHTML= Lwl + " m"

 Bwl = document.getElementById('Bwl').value
//  document.getElementById('displayBwl').innerHTML= Bwl + " m"
 Bwl =  parseFloat(Bwl)
 T = document.getElementById('T').value
 T = parseFloat(T)
//  document.getElementById('displayT').innerHTML= T + " m"

Lb = document.getElementById('Lb').value
Lb = parseFloat(Lb)

 TA = document.getElementById('TA').value
 TA = parseFloat(TA)
//  document.getElementById('displayTA').innerHTML= TA + " m"

 Tf = document.getElementById('Tf').value
 Tf = parseFloat(Tf)
//  document.getElementById('displayTf').innerHTML= Tf + " m"

 ABT = document.getElementById('ABT').value
 ABT = parseFloat(ABT)
//  document.getElementById('displayABT').innerHTML= ABT + " m^2"

wind_speed = document.getElementById('windSpeed').value
wind_speed  = parseFloat(wind_speed)
 hB = document.getElementById('hB').value
 hB= parseFloat(hB)
//  document.getElementById('displayhB').innerHTML= hB + " m"
 AT = document.getElementById('AT').value
 AT = parseFloat(AT)
//  document.getElementById('displayAT').innerHTML= AT + " m^2"

 Cb = document.getElementById('Cb').value
 Cb = parseFloat(Cb)
//  document.getElementById('displayCb').innerHTML= Cb

 Cm = document.getElementById('Cm').value
 Cm =  parseFloat(Cm)
//  document.getElementById('displayCm').innerHTML= Cm
 //lcb
 LCB = document.getElementById('LCB').value
 LCB = parseFloat(LCB)
 lcb_type = document.getElementById("lcb_type").value
//  document.getElementById('displayLCB').innerHTML= LCB

 cross_section_area = document.getElementById('AirArea').value

 cross_section_area =  parseFloat(cross_section_area)


 S_APP_input = document.getElementById('S_APP').value // IF total wetted area of the appenadages are know 
 S_APP_input = parseFloat(S_APP_input)
 
//  document.getElementById('displayAirArea').innerHTML= cross_section_area + " m^2"

 wave_height  = document.getElementById('H').value
 wave_height =  parseFloat( wave_height)

//  document.getElementById('displayH').innerHTML= wave_height + " "

 updateResistance()
// environment()
}

function sternType(event){
  sternId = document.getElementById('stern').value
  screw = document.getElementById('screw').value
    if(sternId === "Normal"){
            stern = 0
      }
     else if(sternId === "V"){
             stern = -10
      }
     else if(sternId === "U&Hogner"){
            stern = 10
     }
     else if(sternId === "PramWithGondola"){
            stern = -25
      }
         updateResistance()
}

function displayResistance(){
  document.getElementById('Fr').innerHTML=  Rf + " "
  document.getElementById('Rw').innerHTML=  Rw+ " "
  document.getElementById('Rapp').innerHTML=  Rapp+ " "
  document.getElementById('Rtb').innerHTML=  Rbt+ " "
  document.getElementById('Rtr').innerHTML=  Rtr+ " "
  document.getElementById('RA').innerHTML=  RA+ " "
  document.getElementById('RAA').innerHTML=  RAA+ " "
  document.getElementById('RAA_wind').innerHTML=  RAA_wind + " "

  document.getElementById('Rb').innerHTML=  Rb + " "
  document.getElementById('Rwave').innerHTML=  Rwave + " "
  document.getElementById('Rfouling').innerHTML=  Rfoul + " "

  document.getElementById('RT_calm').innerHTML=  RT_calm + " "

  document.getElementById('RT').innerHTML=  RT+ " "

}

function Shaft(event){
  const EventID  = event.target.id
  const EventVal  = event.target.value
  if(EventVal ==="single"){
    nShafts = EventVal
  }
  else if(EventVal ==="double"){
    nShafts = EventVal
  }
  propellers(event)
}

function propellers(event){

// const EventID  = event.target.id
// const EventVal  = event.target.value

  D = document.getElementById('D').value
  PD = document.getElementById('PD').value

  Z = document.getElementById('Z').value
  J = document.getElementById('J').value
  AeAo = document.getElementById('AeAo').value
  let reducionGear
  reducionGear = document.getElementById("gear").checked
  if(reducionGear ===true){
    Ns = 0.95
  }else{
    Ns = 0.98
  }

  document.getElementById('displayD').innerHTML=  D + " "
  document.getElementById('displayZ').innerHTML=  Z+ " "
  document.getElementById('displayJ').innerHTML=  J+ " "
  document.getElementById('displayAeAo').innerHTML=  AeAo+ " "
  document.getElementById('displayPD').innerHTML=  PD + " "

    // if(EventID ===)
 propeller.Thrust()

  propeller.wake()
  propeller.KTandKQ()

  // propeller.efficiencies()
  propeller.power()
  // Engine_Marine.Margin()

  if(!KT){
    KT = 0
    KQ = 0
    // W = 0
  }

   document.getElementById('wake').innerHTML=  W + " "
   document.getElementById('KT').innerHTML=  KT+ " "
   document.getElementById('KQ').innerHTML=  KQ+ " "
   document.getElementById('Pe').innerHTML=  Pe_calm + " kW"
   document.getElementById('Pd').innerHTML=  Pd_calm + " kW"
   document.getElementById('thrustP').innerHTML=  Pt_calm + " kW"
   document.getElementById('thrust').innerHTML=  thrust + " kN"
   document.getElementById('No').innerHTML=  No + " "
   document.getElementById('NH').innerHTML=  NH + " "
   document.getElementById('thrustFactor').innerHTML=  TFactor + " "
  //  document.getElementById('Cth').innerHTML=  Cth + " "
  document.getElementById('pb').innerHTML=  Pb + " kW"
  document.getElementById('pb_calm').innerHTML=  Pb_calm + " kW"

   document.getElementById('Va').innerHTML=  Va + " m/s"
  //  document.getElementById('smcr').innerHTML=  SMCR + " kW"
   document.getElementById('propeller_speed').innerHTML=  propel_speed + "s^-1"
}

function updateResistance(){
let c,k,val,i,s
      intervalResis = 0
     s = shipSpeedKnots*0.5144
    val = shipSpeedKnots;
   resistanceDisplay ()

    //  n = 20
        c = 1;
        i = 0;
        k =1;
      for ( k = 1; k < val;k ++) {
        if(val-k > 1 ){
             shipSpeed = k*0.5144
             shipSpeedKnots = k
              }
              else if(val-k <= 1){
                shipSpeed = s
                shipSpeedKnots = val
                 calResistnace.totalResistance()
                if(RT){
                  displayResistance()
                 intervalResis = 2
                 propellers()
                //  resistanceDisplay ()
                }
              }
          calResistnace.totalResistance()
         
          Plotly.extendTraces('resistanceGraph', {
            x: [[shipSpeedKnots]],
            y: [[RT]]
          }, [0], 100)

        }
}

let lastRPM;
let i = 1;
function loadSfoc(val){
    // this is for the percentage Range slider
 document.getElementById('loadDisplay').innerHTML= val + " engine load %"
//  load = (val/100)*enginePower
//  engine_loadPercent = val
// // EngineCal.SFOC(load,enginePower,ratedSfoc,supplier)

// if(i <= 1){
//  sfocDisplay ()
// }
// i++

}


function powerSfoc(val){
    //this is for the power range
 document.getElementById('powerDisplay').innerHTML= val + " engine load kW"
}

function myFunction(val) {

 document.getElementById("demo").innerHTML = val;
 console.log(val)
// // lastRPM= document.getElementById("demo").min;
// // lastRPM= document.getElementById("demo").max;
// document.getElementById('displayRPM').innerHTML= val + " rpm"
// speedRPM = val
//alert("Estimation using the RPM is still under improvemnt !, use other methods")
}

function showEngineDashbaord (){

  document.getElementById("mainDashboard").classList.remove("hide");
  document.getElementById("engineDashboard").classList.remove("hide");
  document.getElementById("engineDashboard").classList.add("grides");
  document.getElementById("power").classList.add("power");
  document.getElementById("load").classList.add("load");
  document.getElementById("torque").classList.add("torque");
  document.getElementById("RPM").classList.add("RPM");
  document.getElementById("loadwatt").classList.add("loadwatt");
  document.getElementById("SFOC").classList.add("SFOC");

}
let size_capacity,size_Crate,size_Crate_peak,life_span,size_DOD, max_time,max_power,chargeDischarge,cal_rate,result_info,size_SOC,chargeDischarge_peak
function battery_sizing(event){
const eventID = event.target.id
const eventVal = event.target.value
const size_margin = 0.1
size_SOC = "updating .... "
if(eventID ==="max_time"){
  max_time = eventVal
  max_time = parseFloat(max_time)
}
else if(eventID==="max_power"){
 max_power = eventVal
 max_power = parseFloat(max_power)
}
else if(eventID==="size_DOD"){
  size_DOD = eventVal
  size_DOD = parseFloat(size_DOD)
}
else if(eventID==="size_c_rate"){
  size_Crate = eventVal
  size_Crate = parseFloat(size_Crate)
}
else if(eventID==="size_c_rate_peak"){
  size_Crate_peak = eventVal
  size_Crate_peak = parseFloat(size_Crate_peak)
  
}
else if(eventID==="life_span"){
  life_span = eventVal
}

if(max_power){

 size_capacity = (max_power*(max_time/60)).toFixed(1)
 cal_rate = (max_power/size_capacity).toFixed(1)

 if(size_Crate){
   size_capacity = ((cal_rate/size_Crate)*size_capacity).toFixed(1)
   size_capacity =  (size_capacity*size_margin)+  size_capacity*1
   chargeDischarge = (size_capacity*size_Crate).toFixed(1)
   size_SOC = size_capacity
   if(size_Crate_peak){

   chargeDischarge_peak = (size_capacity*size_Crate_peak).toFixed(1)

  }

   if(size_DOD){
    size_capacity = size_capacity*1 + (size_capacity*(1-(size_DOD/100)))
    size_capacity = size_capacity.toFixed(1)
   }

 }

if(!max_time){
  size_capacity = 0
}

document.getElementById("size_capacity").innerHTML  = size_capacity + " kWh "
document.getElementById("size_result_crate").innerHTML = size_Crate + " C"
document.getElementById("size_result_SOC").innerHTML = size_SOC + " kWh"
document.getElementById("cont_dischargeCharge").innerHTML  =  chargeDischarge + "kW"
document.getElementById("cont_dischargeCharge_peak").innerHTML  = chargeDischarge_peak + " kW"

}

// document.getElementById("size_capacity").innerHTML
// document.getElementById("size_capacity").innerHTML
// document.getElementById("size_capacity").innerHTML

}

  // using to assign either for engine or genset
  let engineDetail
function displayEngineType(event) {
  event.preventDefault()
  document.getElementById("engineTable").classList.remove("hide");
   //document.getElementById("mainDashboard").classList.remove("hide");
  document.getElementById("batteryTable").classList.add("hide");
  document.getElementById("gensetTable").classList.add("hide");
  document.getElementById("custo_genset").classList.add("hide");
  document.getElementById("custom_engine").classList.remove("hide");
  document.getElementById("select_message").classList.add("hide");
  document.getElementById("battery_sizing").classList.add("hide");

  const table = document.getElementById("Table");
  let i = 0
  let row, custo_eng_details;
  recent_chose_engine = "Main_engine"

  const EventVal = event.target.value
  const EventID = event.target.id
  if(EventID==="choose_sys"){
    if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
    //updating the object that holds the sellected engine and updating it with number of engines installed
    let N0_eng = document.getElementById("N0_eng").value
    sellected_engine = engineDetail
  sellected_engine.No_of_engine = N0_eng //

  document.getElementById("engineTable").classList.add("hide");
   document.getElementById("select_message").classList.remove("hide");
  document.getElementById("select_message_butt").value = "Main engine has been successfully added to the mechinery"
  // document.getElementById("gensetTable").classList.add("hide");
   powerDisplay()
   throw "testing the"
 }

else if (EventVal==="wartsila 32"){
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
}
 engineDetail = wartsila32
}
else if (EventVal==="wartsila 46F") {
  engineDetail = wartsila46
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
}

}
else if(EventID==="custom_engine"){
  if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
  engineDetail = custom_engine
  create_type = EventID
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
 }
}
else if(EventID==="custo_confirm"){
  if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
  engineDetail = created_engine
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
 }
}
engineStrokes =engineDetail.Strokes

 meanPressure = parseFloat(engineDetail.mean_Presure)
 cylinderBore = parseFloat(engineDetail.cylinderBore)
 cylinders = parseFloat(engineDetail.cylinders)
 pistonStroke = parseFloat(engineDetail.pistonStroke)
  main_enginePower = parseFloat(engineDetail.Engine_Power)
 ratedSfoc = parseFloat(engineDetail.SFOC)
 supplier = engineDetail.supplier
 ratedSpeed = parseFloat(engineDetail.Engine_speed)
 enginePower = main_enginePower
 ratedPower = main_enginePower
// EngineCal.torque(engineStrokes,ratedSpeed,meanPressure,cylinderBore,cylinders,pistonStroke)

EngineCal.torque(engineStrokes,ratedSpeed,meanPressure,cylinderBore,cylinders,pistonStroke )
//  EngineCal.SFOC(load,power,ratedSfoc,supplier)

  torqueDisplay () 
  powerDisplay()
  rpmDisplay()
  loadDisplay()
  loadWattDisplay ()
 currentSfocDisplay()

    // updating sliders
  if(engineDetail.speed_type=== "Medium-Speed"){
   rpm_min = 400
   rpm_max = parseFloat(engineDetail.Engine_speed)
 }
 else if(engineDetail.speed_type=== "Slow-Speed"){
   rpm_min = 10
   rpm_max = parseFloat(engineDetail.Engine_speed)
 }
 else if(engineDetail.speed_type=== "Fast-Speed"){
   rpm_min = 1400
   rpm_max = parseFloat(engineDetail.Engine_speed)
 }
    document.getElementById('displayRPM').innerHTML= rpm_min + " minimun rpm"
    document.getElementById('RPM').value = rpm_min
    document.getElementById('RPM').max = rpm_max
    document.getElementById('RPM').min = rpm_min

   minLoad= document.getElementById('load').min
    document.getElementById('loadDisplay').innerHTML= minLoad+ " minimun load %"
    document.getElementById('load').value = minLoad

    minPower = enginePower*0.1

    document.getElementById('power').max = (enginePower-10)
    document.getElementById('power').min = minPower
    document.getElementById('power').value = minPower
    document.getElementById('powerDisplay').innerHTML= minPower+ " minimun desired power "
    let count = Object.keys(engineDetail).length

  for (let [key, value] of Object.entries(engineDetail)) {
    console.log(`${key}: ${value}`);
    document.getElementById("engineTable").classList.remove("hide");

      let table = document.getElementById("Table");
    //   table.classList.remove("hide")
       row = table.insertRow(i)
     console.log(row)
    row.insertCell(0).innerHTML =`<strong>`+`${key}:</strong> `;
    row.insertCell(1).innerHTML = `<strong>` +`${value}`+ "</strong>";
    i++;
  }
  let header= table.createTHead();
    let newRow = header.insertRow(0);
    let Tfooter = table.createTFoot();
    let nfooter = Tfooter.insertRow(0);
    newRow.innerHTML= "<th colspan=12>Product details and specifications </th>"
    if(EventID ==="custom_engine"){
      const y = document.getElementsByClassName("custom")[0]
    nfooter.innerHTML= `<th colspan=12><input type="submit" value="Confirm input" id="custo_confirm" class="tableconfirm"> </th>`
    y.id="custo_confirm"
    }else{
      let newrow = table.insertRow(count+1)
      newrow.insertCell(0).innerHTML =`<strong>N0. of installed engine</strong> `;
      newrow.insertCell(1).innerHTML = `<input type="text" name="" id="N0_eng" required>`
    nfooter.innerHTML= `<th colspan=12><input type="submit" value="choose engine" id="choose_sys" class="tableconfirm"> </th>`
    const x = document.getElementsByClassName("custom")[0]
    x.id="choose_sys"
    }
}
let gensetDetail;
function displayGenSetType(event) {
  event.preventDefault()
  document.getElementById("engineTable").classList.add("hide");
  document.getElementById("gensetTable").classList.remove("hide");
  document.getElementById("batteryTable").classList.add("hide");
  // document.getElementById("mainDashboard").classList.remove("hide");  //this is for dispalying engine darshboard
  document.getElementById("custo_genset").classList.remove("hide");
  document.getElementById("custom_engine").classList.add("hide");
  document.getElementById("battery_sizing").classList.add("hide");
  document.getElementById("select_message").classList.add("hide");
  const table = document.getElementById("genset_Table");
  let i = 0
  let row;

  const EventVal = event.target.value
  const EventID = event.target.id
  recent_chose_engine = "aux_engine" 
 if(EventID==="choose_sys"){
  if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
   let N0_gen = document.getElementById("N0_gen").value
  sellected_genset = gensetDetail
  sellected_genset.No_of_genset = N0_gen
  console.log(sellected_genset)
  document.getElementById("gensetTable").classList.add("hide");
   document.getElementById("select_message").classList.remove("hide");
  document.getElementById("select_message_butt").value = "Generator set has been successfully added to the mechinery"
  // document.getElementById("gensetTable").classList.add("hide");
  document.getElementById("battery_sizing").classList.add("hide");
  document.getElementById("engine_perf").classList.remove("hide");


  throw "testing the"
 }
else if (EventVal==="Wärtsilä_31DF"){

  gensetDetail = genset.GenSet2

  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
}

}
else if(EventVal==="Wärtsilä_34DF"){

  gensetDetail = genset.GenSet1

  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
}

}
else if(EventID==="custom_genset"){
  if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
  // let custom_genset =Generator_sets.customize
  
  gensetDetail = custom_genset
  create_type = EventID

  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
}
}

else if(EventID==="custo_confirm"){
  if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }

  //const created_engine = engineData.custom_created
  gensetDetail = created_genset // update by "custom_engine_genset(event)" when user input data"
  console.log(gensetDetail)
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
}
}

aux_enginePower = parseFloat(gensetDetail.Engine_Power)
aux_meanPressure = parseFloat(gensetDetail.mean_Presure)
 aux_cylinderBore = parseFloat(gensetDetail.cylinderBore)
 aux_cylinders = parseFloat(gensetDetail.cylinders)
 aux_pistonStroke = parseFloat(gensetDetail.pistonStroke)
 Gen_Power = parseFloat(gensetDetail.Gen_Power)
 rated_BSEC = parseFloat(gensetDetail.BSEC)
 engine_effic = gensetDetail.efficiency
 ratedPower = parseFloat(gensetDetail.Engine_Power)

 gen_supplier = gensetDetail.supplier
 aux_ratedSpeed = parseFloat(gensetDetail.Engine_speed)
 speedRPM =aux_ratedSpeed
 if(!gensetDetail.SFOC){
  gensetDetail.SFOC= (((rated_BSEC/42700)*(1-engine_effic)+(rated_BSEC/42700))*1000).toFixed(2)*1 + " g/kWh"
 aux_ratedsfoc = parseFloat(gensetDetail.SFOC)
 }

EngineCal.torque(aux_enginePower,aux_ratedSpeed,aux_meanPressure,aux_cylinderBore,aux_cylinders,aux_pistonStroke )
//  EngineCal.SFOC(load,power,ratedSfoc,supplier)
// engine.Margin()
//  torqueDisplay ()
//  powerDisplay()
//  rpmDisplay()
//  loadDisplay()
//  loadWattDisplay ()
//  currentSfocDisplay()

    // updating sliders

    document.getElementById('displayRPM').innerHTML= rpm_min + " minimun rpm"
    document.getElementById('RPM').value = rpm_min
    document.getElementById('RPM').max = rpm_max
    document.getElementById('RPM').min = rpm_min

   minLoad= document.getElementById('load').min
    document.getElementById('loadDisplay').innerHTML= minLoad+ " minimun load %"
    document.getElementById('load').value = minLoad
    enginePower = aux_enginePower
    minPower = enginePower*0.1

    document.getElementById('power').max = (enginePower-10)
    document.getElementById('power').min = minPower
    document.getElementById('power').value = minPower
    document.getElementById('powerDisplay').innerHTML= minPower+ " minimun desired power "

  let count = Object.keys(gensetDetail).length

  //displaying the data in a table
  for (let [key, value] of Object.entries(gensetDetail)) {

    document.getElementById("gensetTable").classList.remove("hide");

      let table = document.getElementById("genset_Table");
    //   table.classList.remove("hide")
       row = table.insertRow(i)
     console.log(row)
     console.log(i)
    row.insertCell(0).innerHTML =`<strong>`+`${key}:</strong> `;
    row.insertCell(1).innerHTML = `<strong>` +`${value}`+ "</strong>";
    i++;
    // row = table.insertRow(i)
  }
  let header= table.createTHead();
    let newRow = header.insertRow(0);
    let Tfooter = table.createTFoot();
    let nfooter = Tfooter.insertRow(0);
    newRow.innerHTML= "<th colspan=12>Product details and specifications </th>"
    if(EventID ==="custom_genset"){
    nfooter.innerHTML= `<th colspan=12><input type="submit" value="Confirm input" id="custo_confirm" class="tableconfirm"> </th>`
    const x = document.getElementsByClassName("custom")[2]
    x.id="custo_confirm"
    }else{
      let newrow = table.insertRow(count+1)
      newrow.insertCell(0).innerHTML =`<strong>N0. of installed genset</strong> `;
      newrow.insertCell(1).innerHTML = `<input type="text" name="" id="N0_gen" required>`
     nfooter.innerHTML= `<th colspan=12><input type="submit" value="choose Genset" id="choose_sys" class="tableconfirm"> </th>`
     const x = document.getElementsByClassName("custom")[2]
    x.id="choose_sys"
    }
}
let batteryDetail

function displayBatteryType(event) {
  event.preventDefault()
  document.getElementById("bat_Table").classList.remove("hide");
  document.getElementById("engineTable").classList.add("hide");
  document.getElementById("mainDashboard").classList.add("hide");
  document.getElementById("gensetTable").classList.add("hide");
  document.getElementById("select_message").classList.add("hide");
  document.getElementById("battery_sizing").classList.add("hide");
  document.getElementById("custom_battery").classList.remove("hide");

  const table = document.getElementById("bat_Table");
  let i = 0
  let row,c_ratec_rate,custom_batteryDetail,DOD;

  const EventVa = event.target.value
  const EventID = event.target.id

 if(EventVa ==="battery_sizing"){
  document.getElementById("battery_sizing").classList.remove("hide");
    document.getElementById("select_message").classList.add("hide");
    document.getElementById("bat_Table").classList.add("hide");
    document.getElementById("custom_battery").classList.add("hide");
  return "sizing the battery "
 }
 else if(EventID==="choose_sys"){
  if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
  sellected_battery = batteryDetail
  console.log(sellected_battery)
  document.getElementById("batteryTable").classList.add("hide");
  document.getElementById("select_message").classList.remove("hide");
  document.getElementById("engine_perf").classList.add("hide");
  document.getElementById("select_message_butt").value = "Battery pack has been successfully added to the mechinery"
  
   throw "testing the"
 }

else if (EventVa==="Orca_Energy"){
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
  batteryDetail = battery.corvus2
}
}
else if (EventVa==="Blue_Whale"){
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
  batteryDetail = battery.corvus1
}
}
//display the customized babttery details
else if(EventID ==="custom_battery"){

      if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
  batteryDetail = custom_battery
}
}
else if(EventID ==="custo_confirm"){
  while (table.hasChildNodes()) {
  table.removeChild(table.firstChild);
  batteryDetail = created_battery
}
}

 capacity = parseFloat(batteryDetail.capacity)
 c_rate = parseFloat(batteryDetail.c_Rate)
  c_rate_peak = parseFloat(batteryDetail.c_Rate_peak)
  DOD = parseFloat(batteryDetail.DOD)

  if(!c_rate_peak){
    c_rate_peak = c_rate;
  }
  batteryDetail.cont_charging_power = (capacity*c_rate).toFixed(1)
    batteryDetail.peak_charging_power = (capacity*c_rate_peak).toFixed(1)
    batteryDetail.SOC = capacity*(DOD/100) + " kWh"
  // loop over the object of the battery details and display them on the table
  for (let [key, value] of Object.entries(batteryDetail)) {
    console.log(`${key}: ${value}`);
    document.getElementById("batteryTable").classList.remove("hide");
      let table = document.getElementById("bat_Table");
    //   table.classList.remove("hide")
       row = table.insertRow(i)
     console.log(row)
    row.insertCell(0).innerHTML =`<strong>`+`${key}:</strong> `;
    row.insertCell(1).innerHTML = `<strong>` +`${value}`+ "</strong>";
    i++;
  }
  let header= table.createTHead(); // create table haeder
    let newRow = header.insertRow(0);
    newRow.innerHTML= "<th colspan=12>Product details and specifications </th>"
    let Tfooter = table.createTFoot();
    let nfooter = Tfooter.insertRow(0);

    if(EventID ==="custom_battery"){
    nfooter.innerHTML= `<th colspan=12><input type="submit" value="Confirm input" id="custo_confirm" class="tableconfirm"></th>`
    const x = document.getElementsByClassName("custom")[1]
    x.id="custo_confirm"
    }else{
    nfooter.innerHTML= `<th colspan=12><input type="submit" value="choose battery pack" id="choose_sys" class="tableconfirm" > </th>`
    const x = document.getElementsByClassName("custom")[1]
    x.id="choose_sys"
    }

}

function custom_battery_pack(event){
 //capturing the input date for the customized battery and creating a new battery pack
 if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
   const eventID = event.target.id
  const eventVal = event.target.value

      if(eventID==="supplier"){
        created_battery.supplier = eventVal
      }
      else if(eventID==="c_Rate_peak"){
        created_battery.c_Rate_peak = eventVal + " c"
      }
      else if(eventID==="c_Rate"){
        created_battery.c_Rate = eventVal + " c"
      }
      else if(eventID==="lifeCycle"){
        created_battery.lifeCycle = eventVal
      }
      else if(eventID==="DOD"){
        created_battery.DOD = eventVal
      }
      else if(eventID==="voltage"){
        created_battery.voltage = eventVal + " kV"
      }
      else if(eventID==="capacity"){
        created_battery.capacity = eventVal + " kWh"
      }
      else if(eventID==="nor_Voltage"){
        created_battery.nor_Voltage = eventVal + " VDC"
      }
      else if(eventID==="weight"){
        created_battery.weight = eventVal + " mm"
      }
      else if(eventID==="heigh"){
        created_battery.height = eventVal + " mm"
      }
      else if(eventID==="width"){
        created_battery.width = eventVal + " mm"
      }
      else if(eventID==="depth"){
        created_battery.depth = eventVal + " mm"
      }
}

function custom_engine_genset(event){
 //capturing the input data for the customized battery and creating a new battery pack
 if(!propulsion_syst){
    alert("choose propulsion system first")
    throw "propulsion system unknow"
  }
  const created_engine = engineData.custom_created
  const created_genset =Generator_sets.custom_created

  create_type // using to assign either for engine or genset
 let object_detail

 if(create_type==="custom_engine"){
   //create new engine object
   object_detail = created_engine
 }
 else if(create_type==="custom_genset"){
  object_detail = created_genset
 }
 const eventID = event.target.id
  const eventVal = event.target.value
  // alert(eventID)
if(eventID==="supplier"){
  object_detail.supplier = eventVal
   }
      else if(eventID==="frequency"){
        object_detail.frequency = eventVal +" Hz"
      }
      else if(eventID==="rpm"){
        object_detail.Engine_speed = eventVal + " rpm"
      }
      else if(eventID==="SFOC"){
        object_detail.SFOC = eventVal + " g/kWh"

      }
      else if(eventID==="BSEC"){
        object_detail.BSEC = eventVal + " kJ/kWh"

      }
      else if(eventID==="pistonStroke"){
        object_detail.pistonStroke = eventVal + " mm"
      }
      else if(eventID==="cylinderBore"){
        object_detail.cylinderBore = eventVal + " mm"
      }
      else if(eventID==="mean_Presure"){
        object_detail.mean_Presure = eventVal  + " bar"
      }
      else if(eventID==="fuel_type"){
        object_detail.fuel_type = eventVal
        if(eventVal==="LNG"){
          object_detail.LHV = "48 MJ/kg"

        }
        else if(eventVal==="MDO" || eventVal==="MGO"){
          object_detail.LHV = "42.7 MJ/kg"
        }
        else if(eventVal==="HFO"){
          object_detail.LHV = "40.2 MJ/kg"
        }
      }
      else if(eventID==="Engine_Power"){
        object_detail.Engine_Power = eventVal + " kW"
        alert("testing")
      }
      else if(eventID==="Gen_Power"){
        object_detail.Gen_Power = eventVal + " kW"
      }
      else if(eventID==="efficiency"){
        object_detail.efficiency = eventVal
      }
      else if(eventID==="speed_type"){
        object_detail.speed_type = eventVal
      }
      else if(eventID==="Strokes"){
        object_detail.Strokes = eventVal + " mm"
      }
}

function powerOn(event){
  const Eventval = "power"
  const eventID = event.target.id
  if(eventID ==="powerOn"){
    engineDashboard(Eventval ,Ptotal)
  }
  else if(eventID ==="done"){
document.getElementById("mainDashboard").classList.add("hide")
  
  document.getElementById("SFOC").classList.add("hide")
  }

}



function engineDashboard(EventID ,val ){
  let type,used_sfoc,used_supplier
  if( recent_chose_engine ==="aux_engine"){
    type = "auxilary";
    used_sfoc = aux_ratedsfoc;
    used_supplier = gen_supplier;
  }else{
    used_sfoc = ratedSfoc;
    used_supplier = supplier
  }
    t = 1
  if(EventID ==='loadInput'|| EventID ==='load'){

    sfocDisplay ()
     c= (10/100)*val;
     n = 10
     if(val >=20 && val <= 100){
        i = 0
      for ( k = 10; k < val;k +=c) {

        inputData(i);
        i++
        }
        function inputData(i) {
        setTimeout(function() {

            console.log(i);
                if(val -n >c ){
                load = (n/100)*enginePower
                EngineCal.SFOC(load,enginePower,used_sfoc,used_supplier,type )
                console.log("this is the load 1",load);
                console.log(type,used_sfoc," type ")
             }else{
            load = (val/100)*enginePower
            EngineCal.SFOC(load,enginePower,used_sfoc,used_supplier,type )
            console.log("this is the load last",load)
            console.log(type,used_sfoc," type ")
                }
                Plotly.extendTraces('plot', {
                x: [[engine_loadPercent]],
                y: [[sfoc_cal]]
              }, [0], 10000)
              n+=c

        }, 1000 * i);
        }

  }
}

  else if(EventID === 'powerInput' || EventID ==='power'){
    sfocDisplay ()
    c= (10/100)*val;
     if(val >=minPower && val <= enginePower){
        i = 0
        n= minPower;
      for ( k = minPower; k < val;k +=c) {
        inputData(i);
        i++
        }

     function inputData(i) {
        setTimeout(function() {
               if(val -n >c ){
                load = n
                EngineCal.SFOC(load,enginePower,used_sfoc,used_supplier,type)
                console.log("this is the load 1",load)
                console.log(type,used_sfoc," type ")
             }else{
            load = val
            EngineCal.SFOC(load,enginePower,used_sfoc,used_supplier,type)
            console.log("this is the load last",load)
            console.log(type,used_sfoc  ," type ")
                }
                Plotly.extendTraces('plot', {
                x: [[engine_loadPercent]],
                y: [[sfoc_display]]
              }, [0], 10000)
              n+=c
        }, 1000 * i);
        }
}

  }
}


function getValues(event){
    let val, k,i, n, c,t
    t = 1
  const EventID = event.target.id;

 if (EventID ==='RPM' || EventID === 'RPMInput') {
      RPM  = event.target.value
      engine_test_type = "RPM"
    if (EventID ==='RPMInput') {
     document.getElementById(EventID).value = ""
    }
}
else if(EventID ==='loadInput'|| EventID ==='load'){
  engine_test_type = "load"
    if( EventID ==='loadInput'){
      val = document.getElementById(EventID).value
      document.getElementById(EventID).value = ""
      document.getElementById("loadDisplay").innerHTML= val + "% engine power"
    }else{
      val  = event.target.value
      document.getElementById("loadDisplay").innerHTML= val + "% engine power"
    }
    engineDashboard(EventID,val)
    power = val 
}
// }
else if(EventID === 'powerInput' || EventID ==='power'){
  engine_test_type = "load"
  if(EventID === 'powerInput'){

    val = parseFloat(document.getElementById(EventID).value)
    document.getElementById(EventID).value = ""
    document.getElementById("powerDisplay").innerHTML= val + " engine load kW"
  }else{
    val = parseFloat(document.getElementById(EventID).value)
  }
  engineDashboard(EventID,val )
   power = val 
}

EngineCal.torque(engineStrokes,ratedSpeed,meanPressure,cylinderBore,cylinders,pistonStroke )

rpmDisplay()
torqueDisplay()

}



//  let simulate,DP_time, habor_time,standby_time,PpowerInstall,
//  star_time,end_time,power_aval,transit_time, FC_total, FC,calm_simulate

function display_sim(event){
 //displaying simulation environment
  if(!propulsion_syst){
    alert("choose propulsion system first")
    document.getElementById("sim_check").checked = false
    throw "propulsion system unknow"
  }
const eventID = event.target.id
const eventVal = event.target.value
const eventcheck = event.target.checked
  const sim_check = document.getElementById("sim_check").checked
 const use_result_check = document.getElementById("use_result").checked
 const define_result_check = document.getElementById("define_result").checked

 if(eventID==="define_result"){
  document.getElementById("main_load").disabled = false;
}
 else if (sim_check ===true){
  document.getElementById("sim_environment").classList.remove("hide")
  document.getElementById("sim_time").required = true
  document.getElementById("aux_load_input").required = true
  // document.getElementById("aux_load_input").required = true

}
else if (sim_check ===false){
  document.getElementById("sim_environment").classList.add("hide")

}

 if(eventID ==="engine_perf"){
  document.getElementById("mainDashboard").classList.remove("hide");
  // document.getElementById("mainDashboard").classList.add("hide")
  // engine.Margin()
// torqueDisplay ()
// powerDisplay()
// rpmDisplay()
// loadDisplay()
// loadWattDisplay ()
// currentSfocDisplay()
}
else if(eventID ==="close"){

  document.getElementById("select_message").classList.add("hide");
  // document.getElementById("mainDashboard").classList.add("hide");

}

if(use_result_check ===true){
  // const sim_check = document.getElementById("sim_environment").checked
  document.getElementById("main_load").disabled = true;

}
else if(define_result_check ===true){
  document.getElementById("main_load").required = true;

}

}

//sim = simulation
let transit_dis_mils

function update_simulation_data(event) {
  const eventID = event.target.id;
  const eventcheck = document.getElementById("wave_check").checked;
  const eventVal = event.target.value;
  
  if(eventID ==="update_shipSpeed"){
    shipSpeedKnots = eventVal*1; 
    shipSpeed = shipSpeedKnots* 0.5144; //m/s
   document.getElementById("update_shipSpeed_show").innerHTML = shipSpeedKnots +" knt"
   updateResistance(); // recalculating the resistance
  
  }
  else if(eventID ==="wave_height_update" || eventID ==="wave_check"){
     
     if( eventcheck === true){
      simulation_environment = "wave_wind";
      wave_height = parseFloat(eventVal);
     wave_height  = wave_height ;
     if(!wave_height)  wave_height = 0 ;
     if(wave_height)  environment.updat_wave = wave_height // environmental wave data

     document.getElementById("wave_update").innerHTML = wave_height  + " m";
     environment.updat_wave = wave_height // environmental wave data
     
     }else{
      wave_height  = wave_height ;
      simulation_environment = "calm";
      document.getElementById("wave_height_update").value =  " "
      document.getElementById("wave_update").innerHTML = " "
     }

  }
  else if(eventID ==="adjust_load"){
    aux_load = parseFloat(eventVal);
  document.getElementById("adjust_load_show").innerHTML = eventVal +" kW"
  }
}

function sim_data(event){
  // display the field and get the input data in the simulation environment
  const eventID = event.target.id;
  const eventcheck = event.target.checked;
  const eventVal = event.target.value;

//uncheck and check type of operation
if(eventID ==="transit"){

//  document.getElementById("standby").checked = false;
 document.getElementById("DP").checked = false;
  // document.getElementById("harbor").checked = false;
//  document.getElementById("transit").checked = true;
// document.getElementById("standby_time_span").classList.add("hide")
//   document.getElementById("standby_time").required = false
  // document.getElementById("harbor_time_span").classList.add("hide")
  // document.getElementById("harbor_time").required = false
  document.getElementById("DP_time_span").classList.add("hide")
  document.getElementById("DP_time").required = false
  // document.getElementById("transit_span").classList.add("hide")
  // document.getElementById("transit_dis").required = false;

}
else if(eventID ==="DP"){
  // document.getElementById("standby").checked = false;
//  document.getElementById("DP").checked = true;
  // document.getElementById("harbor").checked = false;
  document.getElementById("transit").checked =false;

  // document.getElementById("standby_time_span").classList.add("hide")
  // document.getElementById("standby_time").required = false
  // document.getElementById("harbor_time_span").classList.add("hide")
  // document.getElementById("harbor_time").required = false
  // document.getElementById("DP_time_span").classList.add("hide")
  // document.getElementById("DP_time").required = false
  document.getElementById("transit_span").classList.add("hide")
  document.getElementById("transit_dis").required = false;
}
// else if(eventID ==="standby"){
//   // document.getElementById("standby").checked = true;
//  document.getElementById("DP").checked = false;
//   document.getElementById("harbor").checked = false;
//   document.getElementById("transit").checked =false;

//   // document.getElementById("standby_time_span").classList.add("hide")
//   // document.getElementById("standby_time").required = false
//   document.getElementById("harbor_time_span").classList.add("hide")
//   document.getElementById("harbor_time").required = false
//   document.getElementById("DP_time_span").classList.add("hide")
//   document.getElementById("DP_time").required = false
//   document.getElementById("transit_span").classList.add("hide")
//   document.getElementById("transit_dis").required = false;
// }
// else if(eventID ==="harbor"){
//   document.getElementById("standby").checked = false;
//  document.getElementById("DP").checked = false;
//   // document.getElementById("harbor").checked = true;
//   document.getElementById("transit").checked =false;

//   document.getElementById("standby_time_span").classList.add("hide")
//   document.getElementById("standby_time").required = false
//   // document.getElementById("harbor_time_span").classList.add("hide")
//   // document.getElementById("harbor_time").required = false
//   document.getElementById("DP_time_span").classList.add("hide")
//   document.getElementById("DP_time").required = false
//   document.getElementById("transit_span").classList.add("hide")
//   document.getElementById("transit_dis").required = false;
// }
else if (eventID==="None_calm_sim" && eventcheck ===false){
  document.getElementById("wave").classList.add("hide")
  document.getElementById("wave_height").required = false
  environment_type = eventID
}
if(eventID ==="aux_load_input"|| eventID ==="adjust_load"){
  aux_load = eventVal;
  aux_load = parseFloat(aux_load);
  document.getElementById("adjust_load_show").innerHTML = aux_load + " KW"
}
else if(eventID === "main_load"){
Pb_calm = eventVal;
Pb_calm = parseFloat(Pb_calm)
}
else if(eventID==="transit_dis"){
  transit_dis_mils = eventVal
}

 sim_time =  document.getElementById("sim_time").value
 sim_time  = parseFloat(sim_time);
//  transit_dis =  document.getElementById("transit").value
 DP_operat_time =  document.getElementById("DP_time").value;
 DP_operat_time = parseFloat(DP_operat_time);
//  harbor_time =  document.getElementById("DP_time").value;
//  harbor_time = parseFloat(harbor_time);
//  standby_time =  document.getElementById("DP_time").value;
//  standby_time = parseFloat(standby_time);
   wave_height =  document.getElementById("wave_height").value;
  wave_height = parseFloat(wave_height);

 if(eventVal ==="operation"){
  operation = eventID
 }

 if (eventcheck ===true){
  if(eventID ==="opera_time"){
   //display operation time when simulating for DP, Harbor
  document.getElementById("opera_time_span").classList.remove("hide")
  document.getElementById("opera_time").required = true
 }
 else if(eventID ==="None_calm_sim"){
   //display input fieled for wave height when simulating in wave environment
  document.getElementById("wave").classList.remove("hide")
  document.getElementById("wave_height").required = true
 }
 else if(eventID ==="transit"){
   //display input fieled for voyage distance when simulating
  document.getElementById("transit_span").classList.remove("hide")
  document.getElementById("transit_dis").required = true
 }
//  else if(eventID ==="standby"){
//   document.getElementById("standby_time_span").classList.remove("hide")
//   document.getElementById("standby_time").required = true
//  }
//  else if(eventID ==="harbor"){
//   document.getElementById("harbor_time_span").classList.remove("hide")
//   document.getElementById("harbor_time").required = true
//  }
 else if(eventID ==="DP"){
  document.getElementById("DP_time_span").classList.remove("hide")
  document.getElementById("DP_time").required = true
 }

}

display_sim_param()
}

function display_sim_param(){
//getting the properties of the available power sources installed on the vessel
  if(sellected_genset||!sellected_genset){
    if(sellected_genset){
    No_of_genset = parseFloat(sellected_genset.No_of_genset)
    aux_enginePower = parseFloat(sellected_genset.Gen_Power)
    aux_inst_power =No_of_genset* aux_enginePower
    }

    else if(!sellected_genset){
    aux_enginePower = 0
    aux_inst_power = 0
    No_of_genset = 0
  }
  }
    if(sellected_engine){
    No_of_eng =parseFloat(sellected_engine.No_of_engine)
    eng_power = parseFloat(sellected_engine.power)
    main_inst_power = No_of_eng*eng_power
    console.log(sellected_engine)
    }
    else if(!sellected_engine){
    No_of_eng = 0
    eng_power = 0
    main_inst_power = 0
   }
   if(sellected_battery){
    bat_capacity = parseFloat( sellected_battery.capacity)
    bat_SOC = parseFloat(sellected_battery.SOC)
     bat_DOD = parseFloat(sellected_battery.DOD)
    bat_volt = parseFloat(sellected_battery.nor_Voltage)
    bat_C_rated = parseFloat(sellected_battery.c_Rate)
    bat_C_rated_peak = parseFloat(sellected_battery.c_Rate_peak)
    bat_charge_power = parseFloat(sellected_battery.cont_charging_power)
  
  }else if(!sellected_battery) {
    bat_capacity = 0
    bat_SOC = 0
    bat_DOD = 0
    bat_volt = 0
    bat_C_rated = 0
    bat_C_rated_peak = 0
    bat_charge_power= 0
    console.log(bat_SOC,"testing soc zero")
  }

  if(propulsion_syst){
    if(propulsion_syst === "ME"){
      show_propulsion = "Mechanica propulsion (ME)"
    }
    else if(propulsion_syst === "DE_ME"){
      show_propulsion = "Hybrid: DE and ME"
    }
    else if(propulsion_syst === "DE"){
      show_propulsion = "Diesel Electric Propulsion (DE)"
    }
    else if(propulsion_syst === "DE_Battery"){
      show_propulsion = "Diesel Electric with battery Propulsion"
    }
    else if(propulsion_syst === "battery_E"){
      show_propulsion = " Battery electric Propulsion"
    }
  }else if(!propulsion_syst){
    show_propulsion = "not ready"
  }

  if(simulation_period){

    simu_time_show = simulation_period

  }
  else if(!simulation_period){
    sim_time =  document.getElementById("sim_time").value
    simu_time_show = sim_time
  }

  total_insta_power = main_inst_power+ aux_inst_power+bat_charge_power

//display the parameters prameters that has been input or sellected
 document.getElementById("main_eng_power_dis").innerHTML = enginePower + "  kW"
 document.getElementById("main_engine_rpm").innerHTML = ratedSpeed + " rpm"
 document.getElementById("no_engines").innerHTML =  No_of_eng
 document.getElementById("propulsion_p").innerHTML = Pb_calm+ "  kW   "
 document.getElementById("main_installed_power").innerHTML = enginePower  +" kW  "

 document.getElementById("aux_eng_power_dis").innerHTML =  aux_enginePower + "  kw"
  document.getElementById("aux_engine_rpm").innerHTML = aux_ratedSpeed + " rpm"
 document.getElementById("aux_no_engines").innerHTML =  No_of_genset + " "
 document.getElementById("aux_load").innerHTML = aux_load +  " kW  "
 document.getElementById("aux_installed_power").innerHTML = aux_inst_power + " kW  "

 document.getElementById("b_capacity").innerHTML =  bat_capacity
 document.getElementById("c_rate").innerHTML = bat_C_rated
  document.getElementById("c_rate_peak").innerHTML = bat_C_rated_peak
 document.getElementById("DOD_pro").innerHTML =  bat_DOD
 document.getElementById("SOC_pro").innerHTML = bat_SOC + " kWh"
 document.getElementById("volt_pro").innerHTML = bat_volt
 document.getElementById("charge_power").innerHTML =  bat_charge_power + " kW"

 document.getElementById("chose_propulsion").innerHTML =  show_propulsion
 document.getElementById("Total_inst_power").innerHTML =  aux_inst_power + enginePower
  document.getElementById("simulate_time").innerHTML = simu_time_show +" milliseconds"
//  document.getElementById("DOD_pro").innerHTML =  bat_DOD
//  document.getElementById("SOC_pro").innerHTML = bat_SOC + " kWh"
//  document.getElementById("volt_pro").innerHTML = bat_volt
//  document.getElementById("charge_power").innerHTML =  bat_charge_power
}

function dispProSystem(event){

// disable the different power source according propulsion system eg (if you choose mechanical propulsion then battery is disabled)
  const table_eng = document.getElementById("Table");
  const table_bat = document.getElementById("bat_Table");
  const table_gen = document.getElementById("genset_Table");

  const EventValue = event.target.value
  propulsion_type = EventValue

  if(EventValue ==="DE"){
    document.getElementById("engine_select").disabled =true
    document.getElementById("battery_select").disabled =true
    document.getElementById("batteryTable").classList.add("hide");
  }
  else if(EventValue === "ME"){
    document.getElementById("engine_select").disabled =false
    document.getElementById("battery_select").disabled =true
    document.getElementById("genset_select").disabled =false
    document.getElementById("batteryTable").classList.add("hide");
  }
  else if(EventValue === "DE_ME"){
    document.getElementById("battery_select").disabled =true
    document.getElementById("genset_select").disabled =false
    document.getElementById("engine_select").disabled =false
    document.getElementById("batteryTable").classList.add("hide");
}
else if(EventValue === "DE_Battery"){

  document.getElementById("battery_select").disabled =false
  document.getElementById("genset_select").disabled =false
  document.getElementById("engine_select").disabled =true
  document.getElementById("engineTable").classList.add("hide");
}
else if(EventValue === "battery_E"){
  document.getElementById("battery_select").disabled =false
  document.getElementById("genset_select").disabled =true
  document.getElementById("engine_select").disabled =true
  document.getElementById("gensetTable").classList.add("hide");
  document.getElementById("engineTable").classList.add("hide");

}
propulsion_syst = EventValue

}
LiveResult()
// sfocDisplay ()
let required_power, installed_power

function preview(event){
  event.preventDefault()
   check_installed_data()
  const eventID = event.target.id
  if(required_power >=installed_power){
      alert(`Installed power is not enough, the require power is  ${required_power}`)
      return console.log(required_power)
    }
    if(!operation){
      alert("Choose an operation before continue to the next step")
      return "No operation sellected "
    }
    if(sellected_genset.No_of_genset > 5){
      alert(`The maximum numbers of genset allowed is 5  but you installed  ${sellected_genset.No_of_genset}` )
      return "Reduced number of engine"
    }

  if(eventID ==="view_data"){
    document.getElementById("sellected_disp").classList.remove("hide")
    document.getElementById("sim_environment").classList.add("hide")
    display_sim_param()
  }
  else if(eventID ==="sim_display"){
    document.getElementById("sim_environment").classList.remove("hide")
    document.getElementById("sellected_disp").classList.add("hide")

  }
  else if (eventID ==="start_sim"){
    document.getElementById("sellected_disp").classList.add("hide")
    document.getElementById("darshboard_container").classList.remove("hide")
   if(operation==="transit" && propulsion_syst==="ME"){

    main_Simulate(); // for mechanical simulation 
   }else{
     //alert("testing DP")
    DP_operation () 
   }

  }
  else if(eventID ==="rest_soc"){
    bat_SOC = 0;
    document.getElementById("SOC_pro").innerHTML = bat_SOC 
  }
 function check_installed_data(){
   // checking if the installed power source is enough for the required vessel.
   // check for different propulsion system.

   if(propulsion_type ==="DE" || propulsion_type ==="DE_Battery"){
    installed_power =  parseFloat(sellected_genset.Engine_Power)* parseFloat(sellected_genset.No_of_genset)
  }
  else if(propulsion_type ==="ME" ){
    console.log(sellected_engine.power)
    installed_power = parseFloat(sellected_engine.Engine_power)
    const gentset_power = parseFloat(sellected_genset.Engine_Power)* parseFloat(sellected_genset.No_of_genset)

     if(gentset_power*0.8 < aux_load){
        alert(`The installed genset power should be more than 80 % of the required hotel  load of  ${aux_load}`)
        throw "add more capacity to the installed gen set "
     }
     else if(installed_power*0.8 < Pb_calm){
      alert(`The installed main engine power should be more than 80 % of the required propulsion load of  ${Pb_calm}`)
        throw "add more capacity to the installed main engine "
     }
    //  installed_power = installed_power + gentset_power
  }
  else if(propulsion_type ==="DE_ME"){
    const i = parseFloat(sellected_genset.Engine_Power)* parseFloat(sellected_genset.No_of_genset)
    const j = parseFloat(sellected_engine.Engine_Power)* parseFloat(sellected_engine.No_of_engine)
    installed_power =  i + j
  }

  else if(propulsion_type ==="battery_E"){
    installed_power =  parseFloat(sellected_genset.Engine_Power)* parseFloat(sellected_genset.No_of_genset)
    alert("Battery propulsion system is currently not support")
    return
  }
  required_power = aux_load + Pb_calm

 }
 total_insta_power = installed_power +  gentset_power

}

let trans_check,standby_check,harbor_check,DP_check,sim_time,simulation_period,distance_past,time,simulating_time
function main_Simulate(event){
  let type, aux_load_perc,max_load_perc, remain_distance,current_time,new_distance_m,total_combine_load
   trans_check = document.getElementById("transit").checked
  //  standby_check = document.getElementById("standby").checked
   DP_check = document.getElementById("DP").checked
  //  harbor_check = document.getElementById("harbor").checked
   simulating_time = document.getElementById("sim_time").value
  aux_load_perc =(aux_load/aux_enginePower)*100 //TODO: note this needs to be modify to handle many engine
  max_load_perc = (Pb/main_enginePower)*100 //TODO: note this needs to be modify to handle many engine
  environment.updat_wave = wave_height // environmental wave data
 if (trans_check === true){
    // transit_dis = transit_dis_mils*1852 // meters
    // transit_time = (transit_dis/shipSpeed)/3600 //time for transit in seconds
    // remain_distance = transit_dis// transit_time
    // simulation_period = simulating_time*60*1000 // convert the input time to milli seconds
    // time_step = (transit_time*3600*1000/(simulation_period /500)) //time step for every 0.5 seconds
    LiveResult()// live ploting
    simulation_period = sim_time*60*1000
    transit_data = new transiting_details()
  const sim_interv = setInterval(sim, 500);
  let i  = 0
  time = 0;
  FC_ton_aux = 0;
  FC_ton = 0;
  distance_past = 0;
   let assigned_aux_load,aux_active
  const avaliable_power = aux_enginePower
  
   if( aux_load <= avaliable_power*0.8){
    assigned_aux_load = aux_load
    aux_active = 1
   }
   else if(aux_load > avaliable_power*0.8 &&  aux_load < avaliable_power*0.8*2){
    assigned_aux_load = aux_load/2
    aux_active = 2
   }
  
  else if(aux_load > avaliable_power*0.8*2 &&  aux_load < avaliable_power*0.8*3){
    assigned_aux_load = aux_load/3
    aux_active = 3
   }
  else if(aux_load > avaliable_power*0.8 *3 &&  aux_load < avaliable_power*0.8*4){
    assigned_aux_load = aux_load/4
    aux_active = 4
   }
  let new_distance_mils,distance
  distance = 0

  // let propulsion_load
  function sim() {
    
    //  current_time = remain_distance/shipSpeed // recalculating the remaining voyage time
    //  step = current_time*1000/((simulation_period-time)/500) //calculation updated time step
    //  time_step = (step/3600*1000)  //converting milliseconds to hours
    transit_info = transit_data.Parameters()
    time_step = transit_info.time_step

    if(simulation_environment ==="wave_wind" ){
      environment.update_dynamic_load()
      environment.wave_height_cal // current wave height which is calculated
    }
     if(!dynamic_load){
      dynamic_load = 0
     }
     total_combine_load = Pb_calm+dynamic_load
    // load = Pb // break power
    type = "main" // the type is only important when it is auxilary calculation
    
    time +=500
    EngineCal.SFOC(total_combine_load,main_enginePower,ratedSfoc,supplier,type)
    FC = total_combine_load*(sfoc_cal/1000)*time_step
    FC_ton += FC/1000
    FC_ton = FC_ton.toFixed(2)*1
    // fuel_Details (FC_ton)
    //for Auxiliary engine and load
     type = "auxilary"
     aux_load // hotel laod and other
     aux_enginePower
     i++
     console.log(i, "count")
     EngineCal.SFOC(assigned_aux_load,aux_enginePower,aux_ratedsfoc,gen_supplier,type)
     FC_aux =  assigned_aux_load*(sfoc_cal_aux/1000)*time_step
     FC_ton_aux += (FC_aux/1000)*aux_active
     let test = 0
     test += FC_aux/1000
     FC_ton_aux = FC_ton_aux.toFixed(2)*1
     FC_ton_aux = FC_ton_aux //compensating for the numbers of engine currently running 
      console.log(FC_ton_aux,aux_active,test,"testing auxillary " )
     //  fuel_Details (FC_ton_aux)
  //   if(simulation_period-time <=499){
  //     time_step = transit_time-sim_time
  //     FC = Pb_calm*(sfoc_cal/1000)*time_step
  //     FC_ton += FC/1000
  //     FC_ton = FC_ton.toFixed(2)*1
  //     // fuel_Details (FC_ton)
  //  // "Auxiliary engine fuel consumption
  //  FC_aux  = assigned_aux_load*(sfoc_cal_aux/1000)*time_step *aux_active
  //    FC_ton_aux += FC_aux/1000
  //    FC_ton_aux = FC_ton_aux.toFixed(2)*1
  //   }

    if (time >=simulation_period) {
      clearInterval(sim_interv);
    } 
   // plotResult()
    ploting_power_darshboard(assigned_aux_load)
    main_display_darshboard(aux_active)
    fuel_Details (FC_ton_aux)
}

}

}

let P_M_S,transit_data
class transiting_details{
  constructor(){
    this.distance = 0;
    this.distance_past = 0;
    this.current_time  = 0;
    this.sim_time= 0
    this.ship_speed = 0;
    if(operation==="transit"){
    this.transit_dis = transit_dis_mils*1852 // meters
    this.transit_time = (this.transit_dis/shipSpeed)/3600 // in hours
    transit_time = this.transit_time
    this.remain_time = this.transit_time;
    this.simulation_period = sim_time*60*1000
    this.remain_distance = this.transit_dis
    // current_time =  // recalculating the remaining voyage time
     this.step = ((this.remain_distance/shipSpeed)*1000)/((this.simulation_period-time)/500)  //calculation updated time step
     this.time_step = this.step/(3600*1000) //converting milliseconds to hours
  }
  }
  Parameters(){

   this.current_time = this.remain_distance/shipSpeed // recalculating the remaining voyage time
   if(Object.is(this.ship_speed,shipSpeed)===false){
    this.ship_speed = shipSpeed
    this.step = (this.current_time*1000)/((this.simulation_period-time)/500)  //calculation updated time step
     this.time_step = this.step/(3600*1000 ) //converting milliseconds to hours
     this.transit_time = this.current_time/3600
     this.sim_time = this.time_step
   }
    //  this.step = (this.current_time*1000)/((this.simulation_period-time)/500)  //calculation updated time step
    //  this.time_step = this.step/(3600*1000) //converting milliseconds to hours
    //this.sim_time +=this.time_step
    this.distance_mils = (shipSpeed*(this.time_step*3600))/1852 // updated distance in mils
    this.distance_meter = (shipSpeed*(this.time_step*3600)) // updated distance in meters
    this.distance += this.distance_mils
    this.distance_past = this.distance
    this.remain_distance = this.transit_dis- (this.distance_past*1852) 
    this.remain_distance_mils = transit_dis_mils-this.distance_past
    //this.ETA = this.current_time/3600
    this.transit_time-=this.sim_time
    this.ETA = this.transit_time
    console.log(this.step,this.time_step, this.sim_time,this.remain_distance_mils,this.ETA)
  return {
    time_step: this.time_step,
    distance_mils: this.distance_mils,
    distance_meter: this.distance_meter,
    remain_distance : this.distance_meter,
    simulation_time : this.simulation_period
  }
  }
}
function DP_operation (){
  let DP_load,engine_nums,engine_power, remain_time,sfoc, current_time,transit_info
  supplier =  sellected_genset.supplier;
  transit_dis_mils = parseFloat(transit_dis_mils)
  FC_ton_aux = 0;
  sfoc = sellected_genset.SFOC;
  sfoc = parseFloat(sfoc);
   engine_nums =  parseFloat(sellected_genset.No_of_genset)
   engine_power =  parseFloat(sellected_genset.Engine_Power)
  sim_time
  DP_operat_time   // is expected input is hours
  time = 0;
  i = 0;
 
  if(operation==="transit"){
    transit_data = new transiting_details()
    console.log(transit_data ,"data test")
    simulation_period = sim_time*60*1000

  }else{
    // for DP operation 
    remain_time= DP_operat_time
    simulation_period = sim_time*60*1000
    time_step = ((DP_operat_time*3600*1000)/(simulation_period/500))/(3600 *1000)
  }
 
  console.log(engine_nums,engine_power,operation,aux_load,supplier,sfoc,"print what i want ")
   P_M_S = new PMS(engine_nums,engine_power,operation,aux_load,bat_SOC,supplier,sfoc)
   console.log(P_M_S)
  const start_sim = setInterval(DP_running, 500);
  LiveResult()// live ploting
 // const battery_pack = new battery_system
  function DP_running(){
    if(simulation_environment === "wave_wind" ){
      environment.update_dynamic_load()
      environment.wave_height_cal // current wave height which is calculated 
    }
   if(operation ==="transit"){
    transit_info = transit_data.Parameters()
     time_step  = transit_info.time_step
     console.log(time_step,"time step main")
   }else{
    remain_time -= (500/(3600*1000))
   }
    
    FC_aux = P_M_S.optimized_engine_load(time_step); // return sfoc of every given time past
    FC_ton_aux += FC_aux/1000
    FC_ton_aux = FC_ton_aux.toFixed(2)*1
    // FC_ton_aux =
     fuel_Details (FC_ton_aux)
    time +=500
    console.log(time,"time")
    if(time >=simulation_period ){
     clearInterval(start_sim)
  }
  console.log(P_M_S)
  online_engine = P_M_S.length; // the current online engine
  console.log(online_engine,P_M_S.length, "online engine at index side")
  main_display_darshboard()
  ploting_power_darshboard()

  }
}

  function ploting_power_darshboard(new_assigned_load) {
   let update1,update5,update2,update3,update4,update6,update7,update8,update9,update10,layout,layout1, display_power,engine_set1_power,engine_set1_load,engine_set2_power,engine_set2_load,total_load,constant_load,
   engine_online_object,main_engine_load,total_online_engine_power
   if(!dynamic_load){
    dynamic_load = 0
   }
    if(propulsion_type ==="ME"){
     const select1 = document.getElementById("online_engine_power")
     select1.options[1].hidden = true;
     select1.options[2].hidden = true;
     select1.options[4].hidden = true;

     total_load = Pb_calm + dynamic_load+aux_load;
    
     constant_load = Pb_calm;
    engine_online_object = parseFloat(sellected_genset.No_of_genset);
    engine_set1_power =aux_enginePower
    main_enginePower // main propulsion engine power
    main_engine_load = Pb_calm+ dynamic_load
    engine_set2_power =  aux_enginePower*engine_online_object
    engine_set2_load = new_assigned_load; // load on each auxiliary engine
    total_online_engine_power  = aux_enginePower*engine_online_object + main_enginePower
    update6 = { name: "genset avaliable power" }     
    update7 = { name: "genset load "}
    }else{
      const select1 = document.getElementById("online_engine_power")
      select1.options[6].hidden = true;
      select1.options[5].hidden = true;
      select1.options[3].hidden = true;
     total_load = P_M_S.load_with_dynamics;
    constant_load = P_M_S.total_combine_load;
     engine_online_object = P_M_S.engine_online_obj;
    total_online_engine_power = P_M_S.combine_engines_power;
    // dynamic_load = P_M_S.dynamic_load
    engine_set1_power = P_M_S.engine_power
    engine_set1_load = engine_online_object.one.load
    engine_set2_power =   P_M_S.engine_power
    engine_set2_load = P_M_S.last_engine_load;
    battery_load = P_M_S.discharging_power;
    battery_power = P_M_S.charging_power;
    update6 = { name: "engines set  2", } 
     update7 = { name: "engines set 2 load "}
    }

    // console.log(battery_power,"battery power")

       //plot every posible result that user might used later but some of them are hiden until the user request to display,
        // the ones with visibility set to false are hidden 
        layout ={ visible : false }
        layout2 ={ visible : true }
        layout1 ={ title :"power darshboard"}
         update1 = { name: "total load"}
        update2 = { name: "constant load"}
        update3 = { name: "avaliable power" }
        update4 = { name: "engine power "}
         update5 = { name: "engines set 1 load " }
      
        update8 = { name: "dynamic load"}
        update9 = { name: " battery power" }
        update10 = {name: " battery load"}
        update11 = { name: " main engine power" }
        update12 = {name: " propulsion load"}

        Plotly.restyle('result', update1, 0);
        Plotly.restyle('result', update2, 1);
        Plotly.restyle('result', update3, 2);
        Plotly.restyle('result', update4, 3);
        Plotly.restyle('result', update5, 4);
        Plotly.restyle('result', update6, 5);
        Plotly.restyle('result', update7, 6);
        Plotly.restyle('result', update8, 7);
        Plotly.restyle('result', update9, 8);
        Plotly.restyle('result', update10, 9);
        Plotly.restyle('result', update11, 10);
        Plotly.restyle('result', update12, 11);

      if(!switch_id || switch_id==="online_engine_power" ){
         //plot every posible result that user might used later but some of them are hiden until the user request to display,
        // the ones with visibility set to false are hidden 

      if(switch_name ==="General_powers"||!switch_name){
        layout1 ={ title :"Power darshboard"};   
        if(propulsion_type ==="ME"){
          Plotly.update('result', layout,layout1, [1,3,4,5,6,9]);// hide those power
         Plotly.restyle('result', layout2, [0,2,7,8,10,11]); // shows this power
        }else{
          Plotly.update('result', layout,layout1, [4,5,6,9,10,11]);// hide those power
         Plotly.restyle('result', layout2, [0,1,2,3,7,8]); // shows this power
        }
       }
       else if(switch_name ==="battery"){
        layout1 ={ title :"battery pack power darshboard"}
        Plotly.update('result', layout,layout1, [0,2,3,4,5,6,10,11]); // hide those power
        Plotly.restyle('result', layout2, [1,7,8,9]); // shows this power

       }
       else if(switch_name ==="engine_set1"){
        
        layout1 ={ title :"set 1 engine  power darshboard"}
        Plotly.update('result', layout,layout1, [0,1,2,5,6,7,8,9,10,11]);// hide those power
        Plotly.restyle('result', layout2, [0,3,4]);// shows this power

       }
       else if(switch_name ==="engine_set2"){
        layout1 ={ title :"Set 2 engine power darshboard"}
        Plotly.update('result', layout,layout1, [1,2,3,4,7,8,9,10,11]);// hide those power
        Plotly.restyle('result', layout2, [0,5,6]);// shows this power
       }
       else if(switch_name ==="engine_set1_set2"){
        layout1 ={ title :"Set 2 VS Set1 engine darshboard"}
        Plotly.update('result', layout,layout1, [0,1,2,7,8,9,10,11]);// hide those power
        Plotly.restyle('result', layout2, [3,4,5,6]);// shows this power
       }
       else if(switch_name === "mian_engine"){
        layout1 ={ title :"Main engine darshboard"}
        Plotly.update('result', layout,layout1, [0,1,2,3,4,5,6,7,9]);// hide those power
        Plotly.restyle('result', layout2, [8,10,11]);// shows this power
       }
       else if(switch_name === "genset_engine"){ 
        layout1 ={ title :"Genset engine darshboard"}
        Plotly.update('result', layout,layout1, [0,1,2,4,7,8,9,10,11]);// hide those power
        Plotly.restyle('result', layout2, [3,5,6]);// shows this power

       }
       else if(switch_name === "mian_genset_engine"){
        layout1 ={ title :"Main engine darshboard"}
        Plotly.update('result', layout,layout1, [0,1,2,4,5,6,7,8,9]);// hide those power
        Plotly.restyle('result', layout2, [3,5,6,10,11]);// shows this power
        // y: [[total_load],[constant_load],[total_online_engine_power],[engine_set1_power],[engine_set1_load],[engine_set2_power],[engine_set2_load], [dynamic_load],[battery_power],[battery_load],[main_enginePower],[main_engine_load]],

       }
       if(!sellected_battery){
        const select1 = document.getElementById("online_engine_power")
        select1.options[7].hidden = true; 
         Plotly.restyle('result', layout, [8,9]);
          battery_load = 0
          battery_power = 0
        }
      // console.log(total_load,"testing load")
      // console.log(total_online_engine_power," total engine power")
      // console.log(engine_set1_power," total engine power")

      if(!dynamic_load){
        dynamic_load = 0
        Plotly.restyle('result', layout2, 7);// shows this power

      }
    }
    Plotly.extendTraces('result', {
        x: [[time],[time],[time],[time],[time],[time],[time],[time],[time],[time],[time],[time]],
        y: [[total_load],[constant_load],[total_online_engine_power],[engine_set1_power],[engine_set1_load],[engine_set2_power],[engine_set2_load], [dynamic_load,dynamic_load],[battery_power],[battery_load],[main_enginePower],[main_engine_load]],
      }, [0,1,2,3,4,5,6,7,8,9,10,11], 10000)  

}

let previous_online_engine

let  switch_name, switch_id;
function switch_displayed_data(event){
  const select = document.getElementById("online_engine_emission");
  const select1 = document.getElementById("online_engine_power")
  const eventID = event.target.id;
  const eventVal = event.target.value; 

  switch_name = eventVal
  switch_id  = eventID
  if(eventID ==="fuel_compare_type"){

  }else{
    ploting_power_darshboard()
  }
  
}
let aux_LNG_cost,aux_LNG_CO2,aux_LNG_NOx,aux_LNG_SOx,aux_LNG_PM,aux_LNG_NMVOC,aux_LNG_volume,
main_LNG_cost,main_LNG_CO2,main_LNG_NOx,main_LNG_SOx,main_LNG_PM,main_LNG_NMVOC,main_LNG_volume,
aux_MDO_cost,aux_MDO_CO2,aux_MDO_NOx,aux_MDO_SOx,aux_MDO_PM,aux_MDO_NMVOC,aux_MDO_volume,
main_MDO_cost,main_MDO_CO2,main_MDO_NOx,main_MDO_SOx,main_MDO_PM,main_MDO_NMVOC,main_MDO_volume,
aux_MGO_cost,aux_MGO_CO2,aux_MGO_NOx,aux_MGO_SOx,aux_MGO_PM,aux_MGO_NMVOC,aux_MGO_volume,
main_MGO_cost,main_MGO_CO2,main_MGO_NOx,main_MGO_SOx,main_MGO_PM,main_MGO_NMVOC,main_MGO_volume,
aux_HFO_cost,aux_HFO_CO2,aux_HFO_NOx,aux_HFO_SOx,aux_HFO_PM,aux_HFO_NMVOC,aux_HFO_volume,
main_HFO_cost,main_HFO_CO2,main_HFO_NOx,main_HFO_SOx,main_HFO_PM,main_HFO_NMVOC,main_HFO_volume, main_update, aux_update,

main_cost,main_CO2,main_NOx,main_SOx,main_PM,main_NMVOC,main_volume,
aux_cost,aux_CO2,aux_NOx,aux_SOx,aux_PM,aux_NMVOC,aux_volume,main_engine_fuel, aux_engine_fuel, DP_break_power

function fuel_Details (FC_ton_aux){

  // getting the currently fuel propertiesw use for main and Auxilairy engine
  if(propulsion_type ==="ME" || propulsion_type ==="DE_ME"){
    if(sellected_engine.fuel_type === "LNG"){
    main_engine_fuel = fuel_property.LNG(FC_ton,"main")
    main_CO2 = main_engine_fuel.LNG_CO2
    main_NOx = main_engine_fuel.LNG_NOx
    main_NMVOC = main_engine_fuel.LNG_NMVOC
    main_SOx = main_engine_fuel.LNG_Sox
    main_PM = main_engine_fuel.LNG_PM
    main_cost = main_engine_fuel.LNG_cost
    main_volume = main_engine_fuel.LNG_volume

     }
     else if(sellected_engine.fuel_type === "MGO"){
    main_engine_fuel = fuel_property.MGO(FC_ton,"main")
    main_CO2 = main_engine_fuel.MGO_CO2
    main_NOx = main_engine_fuel.MGO_NOx
    main_NMVOC = main_engine_fuel.MGO_NMVOC
    main_SOx = main_engine_fuel.MGO_Sox
    main_PM = main_engine_fuel.MGO_PM
    main_cost = main_engine_fuel.MGO_cost
    main_volume = main_engine_fuel.MGO_volume

     }
     else if(sellected_engine.fuel_type === "MDO"){
    main_engine_fuel = fuel_property.MDO(FC_ton,"main")
    main_CO2 = main_engine_fuel.MDO_CO2
    main_NOx = main_engine_fuel.MDO_NOx
    main_NMVOC = main_engine_fuel.MDO_NMVOC
    main_SOx = main_engine_fuel.MDO_Sox
    main_PM = main_engine_fuel.MDO_PM
    main_cost = main_engine_fuel.MDO_cost
    main_volume = main_engine_fuel.MDO_volume
   
     }
    else if(sellected_engine.fuel_type === "HFO"){
    main_engine_fuel = fuel_property.HFO(FC_ton,"main")
    main_CO2 = main_engine_fuel.HFO_CO2
    main_NOx = main_engine_fuel.HFO_NOx
    main_NMVOC = main_engine_fuel.HFO_NMVOC
    main_SOx = main_engine_fuel.HFO_Sox
    main_PM = main_engine_fuel.HFO_PM
    main_cost = main_engine_fuel.HFO_cost
    main_volume = main_engine_fuel.HFO_volume
    }

    main_update = [main_CO2,main_SOx,main_NOx,main_NMVOC]
     }

     if(sellected_genset.fuel_type === "LNG"){
    aux_engine_fuel = fuel_property.LNG(FC_ton_aux,"Auxiliary")
    aux_CO2 = aux_engine_fuel.LNG_CO2_Aux
    aux_NOx = aux_engine_fuel.LNG_NOx_Aux
    aux_NMVOC = aux_engine_fuel.LNG_NMVOC_Aux
    aux_SOx = aux_engine_fuel.LNG_Sox_Aux
    aux_PM = aux_engine_fuel.LNG_PM_Aux
    aux_cost = aux_engine_fuel.LNG_cost_Aux
    aux_volume = aux_engine_fuel.LNG_volume_Aux

     }
     else if(sellected_genset.fuel_type === "MGO"){
    aux_engine_fuel = fuel_property.MGO(FC_ton_aux,"Auxiliary")
    aux_CO2 = aux_engine_fuel.MGO_CO2_Aux
    aux_NOx = aux_engine_fuel.MGO_NOx_Aux
    aux_NMVOC = aux_engine_fuel.MGO_NMVOC_Aux
    aux_SOx = aux_engine_fuel.MGO_Sox_Aux
    aux_PM = aux_engine_fuel.MGO_PM_Aux
    aux_cost = aux_engine_fuel.MGO_cost_Aux
    aux_volume = aux_engine_fuel.MGO_volume_Aux

     }
     else if(sellected_genset.fuel_type === "MDO"){
    aux_engine_fuel = fuel_property.MDO(FC_ton_aux,"Auxiliary")
    aux_CO2 = aux_engine_fuel.MDO_CO2_Aux
    aux_NOx = aux_engine_fuel.MDO_NOx_Aux
    aux_NMVOC = aux_engine_fuel.MDO_NMVOC_Aux
    aux_SOx = aux_engine_fuel.MDO_Sox_Aux
    aux_PM = aux_engine_fuel.MDO_PM_Aux
    aux_cost = aux_engine_fuel.MDO_cost_Aux
    aux_volume = aux_engine_fuel.MDO_volume_Aux
   
     }
    else if(sellected_genset.fuel_type === "HFO"){
    aux_engine_fuel = fuel_property.HFO(FC_ton_aux,"Auxiliary")
    aux_CO2 = aux_engine_fuel.HFO_CO2_Aux
    aux_NOx = aux_engine_fuel.HFO_NOx_Aux
    aux_NMVOC = aux_engine_fuel.HFO_NMVOC_Aux
    aux_SOx = aux_engine_fuel.HFO_Sox_Aux
    aux_PM = aux_engine_fuel.HFO_PM_Aux
    aux_cost = aux_engine_fuel.HFO_cost_Aux
    aux_volume = aux_engine_fuel.HFO_volume_Aux

     }
      aux_update = [aux_CO2,aux_SOx,aux_NOx,aux_NMVOC,aux_PM]

      updatChat()
 function updatChat(){
   if(propulsion_type ==="ME" || propulsion_type ==="DE_ME"){
    myChart.data.datasets[0].data =  main_update;
   }

  myChart.data.datasets[1].data =aux_update ;
  myChart.update();
 }
 console.log(FC_ton_aux, "this is the FC")
 return {
    aux_CO2,
    aux_NOx ,
    aux_NMVOC ,
    aux_SOx,
    aux_PM ,
    aux_cost,
    aux_volume 
 }
}

function main_display_darshboard(aux_active_engine){
  let wave,distance_N_mils,aux_active,active,ETA, display_speed, calculated_wave
   distance_N_mils = transit_data.remain_distance_mils //transit_dis_mils - distance_past //distance covered so far
   ETA = transit_data.ETA //transit_time - 
   ETA =  ETA.toFixed(2)
   distance_N_mils  = distance_N_mils.toFixed(2)
   calculated_wave = environment.wave_height_cal

   console.log("calclated wave", calculated_wave)
  if(wave_height && simulation_environment ==="wave_wind" ){
    if(calculated_wave){
      wave = calculated_wave.toFixed(2)*1
    }else{
      wave = wave_height
    }
  }else {
    wave = 0
  }
  if(operation ==="DP" ){
    display_speed = 0
    aux_active = online_engine
    distance_N_mils  =0;
    ETA = 0;
    No_of_eng = 0;
    sfoc_cal = 0;
    FC_ton = 0;
    main_enginePower = 0;
  }else {
    if(propulsion_syst ==="DE"){
      aux_active = online_engine 
    }else{
      aux_active = aux_active_engine
    }
    display_speed = shipSpeedKnots
    
    
  }
  // impliment active engine status TODO:

  active = " updating...." // for the main engine

  document.getElementById("main_install_darsh").innerHTML = main_enginePower * No_of_eng
  document.getElementById("main_FC_darsh").innerHTML = FC_ton
  document.getElementById("main_active_engine_darsh").innerHTML = active
  document.getElementById("main_no_engines_darsh").innerHTML = No_of_eng
  document.getElementById("main_load_darsh").innerHTML = Pb_calm
  document.getElementById("main_sfoc_darsh").innerHTML = sfoc_cal

  document.getElementById("aux_install_darsh").innerHTML = aux_enginePower*No_of_genset
  document.getElementById("aux_FC_darsh").innerHTML = FC_ton_aux
  document.getElementById("aux_active_engine_darsh").innerHTML = aux_active
  document.getElementById("aux_no_engines_darsh").innerHTML = No_of_genset
  document.getElementById("aux_load_darsh").innerHTML = aux_load
  document.getElementById("aux_sfoc_darsh").innerHTML = sfoc_cal_aux

  document.getElementById("wave_height_show").innerHTML = wave + " m"
  document.getElementById("ETA").innerHTML = ETA +" Hrs"
  document.getElementById("distance_Mils").innerHTML = distance_N_mils +" nm"
  document.getElementById("speed_show").innerHTML = display_speed

  document.getElementById("capacity_darsh").innerHTML = bat_capacity
  document.getElementById("soc_darsh").innerHTML = bat_SOC
  document.getElementById("DOD_darsh").innerHTML = bat_DOD
  document.getElementById("c_rate_peak_darsh").innerHTML = bat_C_rated_peak
  document.getElementById("c_rate_darsh").innerHTML = bat_C_rated
}

function compare_result(event){
  let lng_compare_aux,lng_compare_main,mgo_compare_aux,mgo_compare_main,mdo_compare_main,mdo_compare_aux,hfo_compare_main,hfo_compare_aux,
update_lng_main,update_lng_aux,update_mgo_main,update_mgo_aux,update_hfo_aux, update_hfo_main,update_mdo_aux, update_mdo_main,
comapre_main_cost,comapre_Aux_cost,comapre_main_emission,comapre_Aux_emission, comapre_main_FC,comapre_Aux_FC
 const eventID = event.target.id;
 const eventVal= event.target.value;
 if(eventID ==="other_result"){
   document.getElementById("darshboard_container").classList.add("hide")
   document.getElementById("result_compare").classList.remove("hide")
 }
 else if(eventID ==="show_dasrhboard"){
  document.getElementById("darshboard_container").classList.remove("hide")
   document.getElementById("result_compare").classList.add("hide")
   document.getElementById("result_canvas").classList.add("hide")

 }

 if(eventID){
  lng_compare_main = fuel_property.LNG(FC_ton,"main")
  mgo_compare_aux = fuel_property.MGO(FC_ton_aux,"Auxiliary")

  hfo_compare_aux = fuel_property.HFO(FC_ton_aux,"Auxiliary")

  mdo_compare_aux = fuel_property.MDO(FC_ton_aux,"Auxiliary")

  hfo_compare_main = fuel_property.HFO(FC_ton,"main")
  mgo_compare_main = fuel_property.MGO(FC_ton,"main")

  mdo_compare_main = fuel_property.MDO(FC_ton,"main")
  lng_compare_aux = fuel_property.LNG(FC_ton_aux,"Auxiliary")

 update_lng_main = [lng_compare_main.LNG_CO2,lng_compare_main.LNG_NOx,lng_compare_main.LNG_NMVOC,lng_compare_main.LNG_Sox,lng_compare_main.LNG_PM]

 update_lng_aux =[lng_compare_aux.LNG_CO2_Aux,lng_compare_aux.LNG_NOx_Aux,lng_compare_aux.LNG_NMVOC_Aux,lng_compare_aux.LNG_Sox_Aux,lng_compare_aux.LNG_PM_Aux]
                              
 update_mgo_main =[mgo_compare_main.MGO_CO2,mgo_compare_main.MGO_NOx,mgo_compare_main.MGO_NMVOC,mgo_compare_main.MGO_Sox,mgo_compare_main.MGO_PM]
 update_mgo_aux =[mgo_compare_aux.MGO_CO2_Aux,mgo_compare_aux.MGO_NOx_Aux,mgo_compare_aux.MGO_NMVOC_Aux,mgo_compare_aux.MGO_Sox_Aux,mgo_compare_aux.MGO_PM_Aux]

 update_mdo_main =[mdo_compare_main.MDO_CO2,mdo_compare_main.MDO_NOx,mdo_compare_main.MDO_NMVOC,mdo_compare_main.MDO_Sox,mdo_compare_main.MDO_PM]
 update_mdo_aux =[mdo_compare_aux.MDO_CO2_Aux,mdo_compare_aux.MDO_NOx_Aux,mdo_compare_aux.MDO_NMVOC_Aux,mdo_compare_aux.MDO_Sox_Aux,mdo_compare_aux.MDO_PM_Aux]

 update_hfo_main =[hfo_compare_main.HFO_CO2,hfo_compare_main.HFO_NOx,hfo_compare_main.HFO_NMVOC,hfo_compare_main.HFO_Sox,hfo_compare_main.HFO_PM]
 update_hfo_aux =[hfo_compare_aux.HFO_CO2_Aux,hfo_compare_aux.HFO_NOx_Aux,hfo_compare_aux.HFO_NMVOC_Aux,hfo_compare_aux.HFO_Sox_Aux,hfo_compare_aux.HFO_PM_Aux]
 

 comapre_main_cost =[hfo_compare_main.HFO_cost,mdo_compare_main.MDO_cost,mgo_compare_main.MGO_cost,lng_compare_main.LNG_cost]
 comapre_Aux_cost =[hfo_compare_aux.HFO_cost_Aux,mdo_compare_aux.MDO_cost_Aux,mgo_compare_aux.MGO_cost_Aux,lng_compare_aux.LNG_cost_Aux]

 comapre_main_emission =[hfo_compare_main.HFO_CO2,mdo_compare_main.MDO_CO2,mgo_compare_main.MGO_CO2,lng_compare_main.LNG_CO2]
 comapre_Aux_emission =[hfo_compare_aux.HFO_CO2_Aux,mdo_compare_aux.MDO_CO2_Aux,mgo_compare_aux.MGO_CO2_Aux,lng_compare_aux.LNG_CO2_Aux]

 document.getElementById("result_canvas").classList.remove("hide")

 }
if(eventID ==="show_emission" || eventID === "fuel_compare_type"){
  // emission_comparison.data.labels = ['CO2','NOX','NMVOC','SOX','PM'];
  // emission_comparison.data.datasets[0].data =  update_lng_main;
  //  emission_comparison.data.datasets[1].data =  update_mgo_main;
   
  document.getElementById("change_fuel").classList.remove("hide")
    const passed_ID = "show_emission"
    option_update(passed_ID)
  emission_comparison.data.labels = ["CO2","NOx","NMVOC","SOx","PM"];;

  if(eventVal ==="LNG"){
    emission_comparison.options.title.text = "LNG emission insight"
    emission_comparison.data.datasets[0].data =  update_lng_main;
   emission_comparison.data.datasets[1].data =  update_lng_aux ;
  }
  else if(eventVal ==="MGO"){
    emission_comparison.options.title.text = "MGO emission insight"
    emission_comparison.data.datasets[0].data =  update_mgo_main;
   emission_comparison.data.datasets[1].data =  update_mgo_aux ;
  }
  else if(eventVal ==="MDO"){
    emission_comparison.options.title.text = "MDO emission insight"
    emission_comparison.data.datasets[0].data =  update_mdo_main;
   emission_comparison.data.datasets[1].data =  update_mdo_aux ;
  }
  else if(eventVal ==="HFO"){
    emission_comparison.options.title.text = "HFO emission insight"
    emission_comparison.data.datasets[0].data =  update_hfo_main;
   emission_comparison.data.datasets[1].data =  update_hfo_aux ;
  }else{
    emission_comparison.options.title.text = "LNG emission insight"
    emission_comparison.data.datasets[0].data =  update_lng_main;
   emission_comparison.data.datasets[1].data =  update_lng_aux ;
  }
  // eventID ="show_emission"
  // option_update(eventID)
  emission_comparison.update();
}
else if(eventID ==="show_cost"){
  document.getElementById("change_fuel").classList.add("hide")
  option_update(eventID)
  emission_comparison.options.title.text = " fuel cost compare insight"
   emission_comparison.data.labels =  ["HFO","MDO","MGO","LNG"];
    
    emission_comparison.data.datasets[0].data = comapre_main_cost

    emission_comparison.data.datasets[1].data = comapre_Aux_cost 
 
  // emission_comparison.options.scales.yAxes.ticks=

  emission_comparison.update();
}
else if(eventID ==="show_FC"){
  document.getElementById("change_fuel").classList.add("hide")
  option_update(eventID)
  emission_comparison.options.title.text = "fuel consumption  insight"

  emission_comparison.data.labels =  ["Fuel consumption"];
    
    emission_comparison.data.datasets[0].data = [FC_ton]

    emission_comparison.data.datasets[1].data = [FC_ton_aux]
    
    emission_comparison.update();
}
// else if(eventID ==="show_volume"){
//   document.getElementById("change_fuel").classList.add("hide")

//   emission_comparison.data.labels =  ["HFO","MDO","MGO","LNG"];
    
//     emission_comparison.data.datasets[0].data = comapre_main_cost

//     emission_comparison.data.datasets[1].data = comapre_Aux_cost 
// }


function option_update(type){
  let chart_name, tooltip,tick,tons
  if(type ==="show_cost"){
      tooltip = 'index';
      tick = '$';
      tons = '';
   }
    else if (type ==="show_emission"){
      tooltip =  'index'
      tons = 'Tonns'
      tick = ''
    }
    // else if (type ==="show_volume"){
    //   tooltip ='mode'
    // }
    else if (type ==="show_FC"){
      tooltip = 'index'
      tons = 'Tonns'
      tick = ''
    }
    emission_comparison.options={

    tooltips:{

        mode: tooltip
     },
     title:{
       display: true,
       display: true,
       text: 'Alternative Fuel comparison ',
      fontColor: 'rgb(255, 9, 132)',
       fontSize: 23
     },
    legend:{
        position: 'bottom',
        align: 'center',
      },
    scales:{
    yAxes:[{
      scaleLabel:{
              display: true,
                  labelString: tons,
                  fontColor:'#3bc140',
                 },

      ticks:{
        beginAtZero: true,
      display: true,
        fontColor:'#3bc140',

       callback: function(value, index, values) {
                 return tick + value;
            }
      }
    }]
    }
  }
}
//  updatChat()
 function updatChat(){
  emission_comparison.update();
 }
}

function dashboard_download(event) {
 // const doc = new jsPDF()
  const doc = new jsPDF();
  const downlaod_file = document.getElementById(darshboard_container)
  doc.fromHTML(downlaod_file)
  alert("testinh")
  doc.save("dashbbard")
}
    </script>

</body>
</html>
